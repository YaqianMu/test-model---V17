GAMS 24.4.6  r52609 Released Jun 26, 2015 WEX-WEI x86 64bit/MS Windows 12/05/16 17:23:03 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\sets.gms
GAMS 24.4.6  r52609 Released Jun 26, 2015 WEX-WEI x86 64bit/MS Windows 12/05/16 17:23:03 Page 2
a dynamic CGE model of China economy-environment-energy policy analysis based on 2012 data
C o m p i l a t i o n


   3   
      China-3E
      Author:Yaqian Mu, Tsinghua University (muyaqian00@163.com)
      UpDate:    12-2016
   9   
 252   
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\subsititution elasticit
           ies.gms
 254  *12ÔÂ17ÈÕ£¬ÐÞ¸ÄÁË·Ç»¯Ê¯ÄÜÔ´×ÔÈ»ÒªËØ¹©¸øµÄµ¯ÐÔ
 255   
 256   
 257   
 258  parameter  esub_inv     elasticity of substitution among inputs to investm
      ent
 259             esub_c       elasticity of substitution among inputs to consump
      tion
 260             esub_s       elasticity of substitution among investment types
 261             esub                                                           
      ;
 262  parameter sigma
 263            esub_es
 264            esubva(i)
 265            esubd(i)
 266  ;
 267  *subsititution elasticities from Ke Wang
 268  esub("coal","kl")=0.80;
 269  esub("gas","kl")=0.82;
 270  esub("roil","kl")=0.74;
 271  esub("elec","kl")=0.81;
 272   
 273  esub(i,"ff")=0.6;
 274  esub("gas","ff")=0.5;
 275  esub("coal","ff")=0.7;
 276  esub("elec","ff")=0.4;
 277   
 278  esub_inv   =0.25 ;
 279   
 280  *from Eppa 4.1
 281  esub_c     =0.25 ;
 282  sigma("ene_fd") = 0.4;
 283   
 284  esub_s     =10 ;
 285   
 286   
 287  *from EPPA
 288  sigma("ele_p") = 0.5;
 289  sigma("ene_p") = 1;
 290   
 291  eta("coal") =2.0;
 292  eta("oilgas")=1.0;
 293  eta("agri")=0.5;
 294  eta("mine")=2.0;
 295  eta("gas")=1.0 ;
 296  eta("elec")= 0.5;
 297   
 298  eta("biomass_elec")= 0.5 ;
 299  eta("hydro_elec")= 0.1;
 300  eta("wind_elec")= 1.5 ;
 301  eta("solar_elec")= 1.5 ;
 302  eta("nuclear_elec")= 1 ;
 303   
 304   
 305   
 306   
 307   
 308   
 309   
 310   
 311  parameter eslm  ¸ßË®Æ½ÀÍ¶¯Á¦ÓëÆäËûÒªËØµÄÌæ´úµ¯ÐÔ;
 312   
 313  eslm("l")=1;
 314  eslm("ll")=1.5;
 315  eslm("lh")=1.5;
 316   
 317   
 318  eslm("l")=0;
 319  *eslm("ll")=0;
 320  *eslm("lh")=0;
 321   
 322   
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\emission data.gms
 324   
 325  *----------------------------------------------*
 326  *setup benchmark Emission
 327  *20151215        ¸ù¾ÝEPPA·½·¨£¬Êý¾Ý£¬ÄÜÔ´Æ½ºâ±í£¬Í¶Èë²ú³ö±í¸üÐÂ2010ÄêÅÅ·ÅÊ
      ý¾Ý£¬È·¶¨ÅÅ·ÅÏµÊý
 328  *20161201        ¸ù¾ÝEPPA·½·¨£¬Êý¾Ý£¬ÄÜÔ´Æ½ºâ±í£¬Í¶Èë²ú³ö±í¸üÐÂ2012ÄêÅÅ·ÅÊ
      ý¾Ý£¬È·¶¨ÅÅ·ÅÏµÊý
 329  *----------------------------------------------*
 330   
 331  *== CO2 emission data
 332   
 333  *$CALL GDXXRW.EXE emission.xlsx par=edata rng=A1:I11    par=climit   rng=A
      14:C31
 334   
 335  *Parameter edata(*,*) input data of emission;
 336  *Parameter climit(*,*) input data of emission;
 337  *$GDXIN emission.gdx
 338  *$LOAD edata
 339  *$LOAD climit
 340  *$GDXIN
 341   
 342  *parameters for energy and emission accounts
 343  parameter emission0(pollutant,pitem,*,*)  sectoral emission by source
 344            Temission0                     sectoral emission
 345            Temission1                     Total emission
 346            Temission2;
 347   
 348   
 349  parameter
 350  epslon        coefficient of carbon contents (100M tons per EJ)
 351  eet1          energy consumption in Íò¶Ö±ê×¼Ãº      µÈÐ§ÃººÄ
 352  eet2          energy consumption in Íò¶Ö±ê×¼Ãº      ÈÈµ±Á¿
 353  eej           energy consumption in EJ
 354  eeg           energy goods consumption in billion yuan  except energy as f
      eedstock input
 355  eeg_s         energy goods consumption in billion yuan  except energy as f
      eedstock input by sector
 356  co2f          co2 emission by fuel in 100 million tons(ÒÚ¶Ö)
 357   
 358  r_feed(fe,i)   adjusted Feedstocks use ratio of fuels by pertrochemistry s
      ector
 359  b_CO2(fe)      IEA CO2 emissions 2012 (Billion tonnes)
 360  cj            adjust factor for epslon to match IEA baseline
 361   
 362  ecoef         energy coefficient (Íò¶Ö±ê×¼Ãº per billion yuan)   energy fr
      om quantity of value to physical
 363  ccoef_P       carbon coefficient of production(billion T per Billion yuan)
 364  ccoef_h       carbon coefficient of consumption(billion T per Billion yuan
      )
 365  ;
 366   
 367  table edata (*,*)
 368              coal                 roil                    gas
 369  epslon      0.24686              0.199                   0.137
 370  eet1        200327.100000000     55774.870000000         16441.210000000
 371  eet2        200327.100000000     55774.870000000         16441.210000000
 372  eej         58.71106516          16.3462758              4.818524062
 373  ;
 374   
 375  epslon(fe)       =       edata("epslon",fe);
 376  eet1(fe)          =      edata("eet1",fe);
 377  *eet1(sub_elec)    =      edata("eet1",sub_elec);
 378  eet2(fe)          =      edata("eet2",fe);
 379  *eet2(sub_elec)    =       edata("eet2",sub_elec);
 380  eej(fe)          =       eet1(fe)*10000*1000*7000*1000*4.1868/10**18;
 381   
 382  *==grasped from IEA, CO2 emissions from fuel combustion Highlights, 2015
 383   
 384  b_CO2("coal")=71.539/10 ;
 385  b_CO2("roil")=10.789/10 ;
 386  b_CO2("gas")=2.581/10  ;
 387   
 388  cj(fe)         =       b_CO2(fe)*10*12/44/epslon(fe)/eej(fe);
 389   
 390  co2f(fe)       =       epslon(fe)*cj(fe)*eej(fe)*44/12;
 391   
 392  *==calculated from 2012 energy balance table
 393  r_feed("coal","coal") = 0.504025875;
 394  r_feed("coal","chem") = 0.267979697;
 395  r_feed("roil","chem") = 0.595631707;
 396   
 397  eeg_s(fe,i)        =       int0(fe,i)*(1-r_feed(fe,i));
 398  eeg_s(fe,"cons")   =       cons0(fe);
 399  eeg(fe)          =       sum(i,eeg_s(fe,i)) + eeg_s(fe,"cons");
 400   
 401  ecoef(fe)        =       eet1(fe)/eeg(fe);
 402  ccoef_P(fe)      =       co2f(fe)/eeg(fe);
 403  ccoef_h(fe)      =       ccoef_P(fe);
 404   
 405  display epslon, cj, eet1, eet2, eej,eeg_s,eeg, co2f, ecoef,ccoef_p,ccoef_h
      ;
 406   
 407   
 408  *== air pollutant emission data  SO2 and NOX based on Global Emissions EDG
      AR v4.3.1 from   Non-CO2 Emission by sector 2010.xlsx in emission fold
 409   
 410   
 411  parameter scoef_e(*,*)        SO2 emission million ton per billion yuan
 412            slim                        so2 emission limits million ton;
 413   
 414  parameter ncoef_e(*,*)        NOX emission million ton per billion yuan
 415            nlim                        NOX emission limits million ton;
 416   
 417   
 418   
 419  scoef_e('process',i)     =sam('SO2_emission_process',i)/output0(i);
 420  scoef_e('process','fd')     =sam('SO2_emission_process','household')/sum(i
      ,cons0(i));
 421   
 422  ncoef_e('process',i)     =sam('NOX_emission_process',i)/output0(i);
 423  ncoef_e('process','fd')     =sam('NOX_emission_process','household')/sum(i
      ,cons0(i));
 424   
 425  emission0('co2','e',fe,i)=ccoef_p(fe)*int0(fe,i);
 426   
 427  emission0('co2','e',fe,'fd')=ccoef_h(fe)*cons0(fe);
 428   
 429  emission0('so2','e','process',i)=scoef_e('process',i)*output0(i) ;
 430  emission0('so2','e','process','fd')=scoef_e('process','fd')*sum(i,cons0(i)
      ) ;
 431   
 432  emission0('NOX','e','process',i)=ncoef_e('process',i)*output0(i) ;
 433  emission0('NOX','e','process','fd')=ncoef_e('process','fd')*sum(i,cons0(i)
      ) ;
 434   
 435   
 436  display scoef_e,ncoef_e,emission0;
 437   
 438  * emission account
 439  Temission0('co2',i)=sum(fe,emission0("co2","e",fe,i));
 440  Temission0('co2','fd')=sum(fe,emission0('co2','e',fe,'fd'));
 441   
 442  Temission0('so2',i)=emission0('so2','e','process',i);
 443  Temission0('so2','fd')=emission0('so2','e','process','fd');
 444   
 445  Temission0('NOX',i)=emission0('NOX','e','process',i);
 446  Temission0('NOX','fd')=emission0('NOX','e','process','fd');
 447   
 448  display     Temission0;
 449   
 450  Temission1('co2')=sum(i,Temission0('co2',i))+Temission0('co2','fd');
 451  Temission1('so2')=sum(i,Temission0('so2',i))+Temission0('So2','fd');
 452  Temission1('NOX')=sum(i,Temission0('NOX',i))+Temission0('NOX','fd');
 453  Temission2('co2')=sum((i,fe),emission0("co2","e",fe,i))+sum(fe,emission0("
      co2","e",fe,"fd"));
 454   
 455   
 456  *== parameter for emission cap
 457  parameter
 458  clim          carbon emission allowance
 459  clim_t        trend of carbon emission allowance
 460  clim0         benchmark of carbon emission allowance
 461  clim_s(i)     sectoral carbon emission allowance
 462  clim_h        household carbon emission allowance
 463  ;
 464   
 465  table climit(t,*)     input of emission cap
 466              a                    b
 467  2010        1                    1
 468  2015        0.870031338        0.870031338
 469  2020        0.76262393        0.76262393
 470  2025        0.655022701        0.612717632
 471  2030        0.5626033        0.492277887
 472  ;
 473   
 474  slim                     =0;
 475  clim                     =0;
 476  clim_s(i)                =0;
 477  clim_h                   =0;
 478   
 479  clim_t(t) = climit(t,"b");
 480  clim0=1;
 481   
 482  display     climit,clim_t,clim0,Temission1,Temission2;
 483   
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\electricity.gms
 485  *----------------------------------------------*
 486  *electricity sector division
 487  *20151215 µçÁ¦Êý¾ÝÐÞ¸Äºó£¬´æÔÚÎ¢Ð¡Æ«²î£¬ÓëffactorÓÐ¹Ø£¬ÒÔºó´ý²é
 488  *20161201,¸üÐÂ2012ÄêÊý¾Ý£¬Ê¹ÓÃÐÂµÄ²ð·Ö·½·¨£¬Ô­Êý¾ÝÔÚelectricityÎÄ¼þ¼Ð
 489  *----------------------------------------------*
 491   
 492  Parameter Eprop(*,*) input data of sub-electricity sectors;
 493  *Parameter elec_t(*,*)  electricity generation trend in 100 million kwh;
 494  *Parameter mkup_t(*,*)  markup trend;
GDXIN   C:\Users\hero\Desktop\Github\test model - V17\elec.gdx
--- LOAD  Eprop = 1:Eprop
 497  *$LOAD elec_t
 498  *$LOAD mkup_t
 500   
 501  *=== transfer unit to billion yuan
 502  Eprop(i,sub_elec)=Eprop(i,sub_elec)/100000;
 503  Eprop(f,sub_elec)=Eprop(f,sub_elec)/100000;
 504  Eprop('tax',sub_elec)=Eprop('tax',sub_elec)/100000;
 505   
 506  DISPLAY Eprop;
 507   
 508  parameter
 509           ffshr           fraction of electric sector capital as fixed fact
      or
 510           lelec0          labor in electricity generation
 511           kelec0          capital in electricity generation
 512           ffelec0         fixed factor in electricity generation
 513  *         ffelec_b        fixed factor in base year
 514           intelec0        intermediate input to electricity generation
 515           taxelec0
 516           outputelec0     output of electricity generation
 517           Toutputelec0                                    ;
 518   
 519   
 520   
 521  lelec0(sub_elec) =       Eprop("labor",sub_elec);
 522  kelec0(sub_elec) =       Eprop("capital",sub_elec);
 523   
 524  intelec0(i,sub_elec) =   Eprop(i,sub_elec);
 525  taxelec0(sub_elec)=      Eprop("tax",sub_elec);
 526   
 527  *==to be updata
 528  ffelec0(sub_elec)   =    0;
 529   
 530   
 531  *ffelec_b(sub_elec)   =   ffelec0(sub_elec);
 532   
 533  display taxelec0;
 534   
 535  emission0("so2","e","process",sub_elec)=Eprop("SO2_emission_process",sub_e
      lec)*emission0("so2","e","process","elec");
 536  emission0("so2","e","coal",sub_elec)=Eprop("SO2_emission_coal",sub_elec)*e
      mission0("so2","e","coal","elec");
 537  emission0("so2","e","roil",sub_elec)=Eprop("SO2_emission_oil",sub_elec)*em
      ission0("so2","e","roil","elec");
 538   
 539  emission0("so2","g","process",sub_elec)=Eprop("SO2_production_process",sub
      _elec)*emission0("so2","g","process","elec");
 540  emission0("so2","g","coal",sub_elec)=Eprop("SO2_production_coal",sub_elec)
      *emission0("so2","g","coal","elec");
 541  emission0("so2","g","roil",sub_elec)=Eprop("SO2_production_oil",sub_elec)*
      emission0("so2","g","roil","elec");
 542   
 543  emission0("so2","a","process",sub_elec)=Eprop("SO2_abated_process",sub_ele
      c)*emission0("so2","a","process","elec");
 544  emission0("so2","a","coal",sub_elec)=Eprop("SO2_abated_coal",sub_elec)*emi
      ssion0("so2","a","coal","elec");
 545  emission0("so2","a","roil",sub_elec)=Eprop("SO2_abated_oil",sub_elec)*emis
      sion0("so2","a","roil","elec");
 546   
 547  emission0("co2","e","gas",sub_elec)=Eprop("cO2_emission_naturegas",sub_ele
      c)*emission0("co2","e","gas","elec");
 548  emission0("co2","e","coal",sub_elec)=Eprop("cO2_emission_coal",sub_elec)*e
      mission0("co2","e","coal","elec");
 549  emission0("co2","e","roil",sub_elec)=Eprop("cO2_emission_oil",sub_elec)*em
      ission0("co2","e","roil","elec");
 550   
 551   
 552  parameter enesta   substitution elasticity between different sub_elec    f
      rom EPPA 6
 553            emkup           electricity markup
 554            emkup0          base year electricity markup
 555            p_ff            proportion of fix-factor
 556            check1
 557            check2;
 558  enesta=1.5;
 559   
 560  *== markup factor
 561  emkup(sub_elec)       =      1;
 562  *emkup("wind")    =      1.3;
 563  *emkup("solar")   =      2.5;
 564  *emkup("Biomass")     =      1.8;
 565   
 566  emkup0(sub_elec)      =      emkup(sub_elec);
 567   
 568  outputelec0(sub_elec)=   emkup(sub_elec)*(lelec0(sub_elec)+kelec0(sub_elec
      )+ffelec0(sub_elec)+sum(i,intelec0(i,sub_elec)))+taxelec0(sub_elec);
 569   
 570  *outputelec0(sub_elec)=   emkup(sub_elec)*(lelec0(sub_elec)+kelec0(sub_ele
      c)+sum(i,intelec0(i,sub_elec)))+taxelec0(sub_elec);
 571   
 572  Toutputelec0         =   sum(sub_elec,outputelec0(sub_elec));
 573   
 574  taxelec0(sub_elec)$outputelec0(sub_elec)=taxelec0(sub_elec)/outputelec0(su
      b_elec);
 575   
 576  p_ff(sub_elec)    =      emkup(sub_elec)*ffelec0(sub_elec)/((1-taxelec0(su
      b_elec))*outputelec0(sub_elec));
 577   
 578  check1=output0("elec")-sum(sub_elec,outputelec0(sub_elec));
 579   
 580  fact('capital')=fact('capital')-sum(sub_elec,ffelec0(sub_elec)*emkup(sub_e
      lec));
 581   
 582  *EPPA 6 elecpower Ë®µçºÍºËµçµÄ×ÔÈ»ÒªËØµ¯ÐÔ
 583  esub(sub_elec,"ff")=0.2;
 584  esub("nuclear","ff")=0.6*p_ff("nuclear")/(1-p_ff("nuclear"));
 585  esub("hydro","ff")=0.5*p_ff("hydro")/(1-p_ff("hydro"));
 586  esub("wind","ff")=0.25;
 587  *esub(sub_elec,"ff")=0.4;
 588   
 589   
 590  display lelec0,kelec0,intelec0,outputelec0,taxelec0,tx0,emission0,p_ff,Tou
      tputelec0,check1,esub;
 591   
 592   
 593   
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\ist.gms
 595  *----------------------------------------------*
 596  *IST sector division
 597  *----------------------------------------------*
 599   
 600  Parameter Isprop(*,*) proportion of sub-IST sectors;
GDXIN   C:\Users\hero\Desktop\Github\test model - V17\ist.gdx
--- LOAD  Isprop = 1:isprop
 604   
 605  DISPLAY Isprop;
 606   
 607  set      sub_ist /OBC,EF/
 608   
 609  alias (sub_ist,sub_istc)
 610  parameter
 611           list0          labor in ist generation
 612           kist0          capital in ist generation
 613           intist0        intermediate input to ist generation
 614           taxist0
 615           outputist0     output of ist generation
 616           Toutputist0                                             ;
 617   
 618   
 619  list0(sub_ist) =       isprop("labor",sub_ist)*fact0("labor","IST")  ;
 620  kist0(sub_ist) =       isprop("capital",sub_ist)*fact0("capital","IST")  ;
 621  intist0(i,sub_ist) =   isprop(i,sub_ist)*int0(i,"IST")  ;
 622  taxist0(sub_ist)=      isprop("tax",sub_ist)*sam("tax","IST");
 623  outputist0(sub_ist)=   list0(sub_ist)+kist0(sub_ist)+sum(i,intist0(i,sub_i
      st))+taxist0(sub_ist);
 624  taxist0(sub_ist)$outputist0(sub_ist)=taxist0(sub_ist)/outputist0(sub_ist);
 625  Toutputist0         =   sum(sub_ist,outputist0(sub_ist));
 626  emission0("so2","e","process",sub_ist)=isprop("SO2_emission_process",sub_i
      st)*emission0("so2","e","process","IST");
 627  emission0("so2","e","coal",sub_ist)=isprop("SO2_emission_coal",sub_ist)*em
      ission0("so2","e","coal","IST");
 628  emission0("so2","e","roil",sub_ist)=isprop("SO2_emission_oil",sub_ist)*emi
      ssion0("so2","e","roil","IST");
 629   
 630  emission0("so2","g","process",sub_ist)=isprop("SO2_production_process",sub
      _ist)*emission0("so2","g","process","IST");
 631  emission0("so2","g","coal",sub_ist)=isprop("SO2_production_coal",sub_ist)*
      emission0("so2","g","coal","IST");
 632  emission0("so2","g","roil",sub_ist)=isprop("SO2_production_oil",sub_ist)*e
      mission0("so2","g","roil","IST");
 633   
 634  emission0("so2","a","process",sub_ist)=isprop("SO2_abated_process",sub_ist
      )*emission0("so2","a","process","IST");
 635  emission0("so2","a","coal",sub_ist)=isprop("SO2_abated_coal",sub_ist)*emis
      sion0("so2","a","coal","IST");
 636  emission0("so2","a","roil",sub_ist)=isprop("SO2_abated_oil",sub_ist)*emiss
      ion0("so2","a","roil","IST");
 637   
 638  emission0("co2","e","gas",sub_ist)=isprop("cO2_emission_naturegas",sub_ist
      )*emission0("co2","e","gas","IST");
 639  emission0("co2","e","coal",sub_ist)=isprop("cO2_emission_coal",sub_ist)*em
      ission0("co2","e","coal","IST");
 640  emission0("co2","e","roil",sub_ist)=isprop("cO2_emission_oil",sub_ist)*emi
      ssion0("co2","e","roil","IST");
 641   
 642  display list0,kist0,intist0,outputist0,taxist0,tx0;
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\trend.gms
 644  *----------------------------------------------*
 645  *Parameters with trend
 646  *0317 ¼ÓÈëGDPÇ÷ÊÆ£¬ÀÍ¶¯Á¦Ç÷ÊÆ
 647  *----------------------------------------------*
 649   
 650  Parameter PAT(*,*) parameters with trend;
 651  Parameter RET1(*,*) renewable electricity trend;
 652  Parameter RET2(*,*) renewable electricity trend;
 653  Parameter sffelec_b(*,*)      benchmark fixed factor trend;
 654  Parameter sffelec_bau(*,*)      benchmark fixed factor trend;
GDXIN   C:\Users\hero\Desktop\Github\test model - V17\trend.gdx
--- LOAD  PAT = 1:PAT
--- LOAD  RET1 = 2:RET1
--- LOAD  RET2 = 3:RET2
--- LOAD  sffelec_b = 4:sffelec_b
--- LOAD  sffelec_bau = 5:sffelec_BAU
 662   
 663  Parameter rgdp_b(t)      real gdp pathway;
 664  Parameter rgdp0          real gdp;
 665  Parameter aeei(*)        auto energy effiency index;
 666  Parameter gprod_b(t)    benchmark productivity index;
 667  Parameter gprod0        benchmark productivity index;
 668  Parameter lgrowth_b(t)      labor growth rate;
 669   
 670  Parameter ret0      renewable electricity trend;
 671  Parameter ret_b(t,*)      benchmark renewable electricity trend;
 672   
 673  Parameter sffelec0      benchmark fixed factor trend;
 674  Parameter sffelec1      benchmark fixed factor trend in BAU;
 675   
 676   
 677  rgdp_b(t)=PAT(t,"rgdp");
 678  rgdp0=rgdp_b("2010");
 679  aeei(i)=1;
 680  aeei("fd")=1;
 681  gprod_b(t)=PAT(t,"gprod");
 682  gprod0=gprod_b("2010");
 683  lgrowth_b(t)=PAT(t,"lgrowth");
 684   
 685  sffelec0(sub_elec)=1;
 686  sffelec1(sub_elec)=1;
 687   
 688   
 689   
 690  *²Î¿¼Çé¾°
 691  *ret_b(t,sub_elec)=RET2(t,sub_elec);
 692  *¸ß±ÈÀýÇé¾°
 693  ret_b(t,sub_elec)=RET1(t,sub_elec);
 694   
 695  ret0(sub_elec)=ret_b("2010",sub_elec);
 696   
 697  display PAT,rgdp0,ret0,ret_b;
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\labor market.gms
 699  *----------------------------------------------*
 700  *larbor market
 701  *12ÔÂ11ÈÕ£¬¶ÁÈ¡Êý¾ÝµÄ²¿·Ö¼ÓÈë»ù´¡¹¤×Ê¡¢»ù´¡Ê§ÒµÂÊ£¬·ÖÀàµÄÀÍ¶¯Á¦Í¶ÈëÓÉ±ÈÀý¸
      ÄÎªÊýÖµ
 702  *12ÔÂ16ÈÕ£¬³õÊ¼ÀÍ¶¯Á¦¹©¸øÁ¿°üÀ¨¾ÍÒµÁ¿+Ê§ÒµÁ¿    ×¢ÒâÀÍ¶¯¹©¸øÁ¿ºÍ¾ÍÒµÁ¿Ö®¼ä
      µÄ×ª»¯
 703  *12ÔÂ28ÈÕ£¬ÀÍ¶¯Á¦½á¹¹2016Äê¿ªÊ¼±ä»¯
 704  *20161204, update: extend the types of labor to 28 by gender by region by 
      education
 705  *----------------------------------------------*
 706   
 707  set lm labor type /L1*L28/
 708      region /urban,rural/
 709      gender /male,female/
 710      education /     ul unlettered
 711                      es "elementart school"
 712                      ms "middle school"
 713                      hs "high school"
 714                      jc "junior college"
 715                      rc "regular college"
 716                      pg "postgraduate"      /
 717      Level /low,high/;
 718   
 719  alias (lm,lmm)             ;
 720   
 721  * data handling in fold education$region, grasp from output.xlsx
 723   
 724  Parameter labor_v0(*,*)  sectoral labor costs value by labor type in 10 th
      ousand yuan;
 725  Parameter labor_q0(*,*)  sectoral labor quantity by labor type;
 726  Parameter labor_w0(*,*)  sectoral labor wage value by labor type in 10 tho
      usand yuan;
 727  parameter labordata(*,*);
 728   
GDXIN   C:\Users\hero\Desktop\Github\test model - V17\labor.gdx
 730   
--- LOAD  labor_v0 = 2:labor_v0
--- LOAD  labor_q0 = 1:labor_q0
--- LOAD  labordata = 3:labordata
 734   
 735  labor_w0(i,lm)$labor_q0(i,lm) =labor_v0(i,lm)/labor_q0(i,lm);
 736   
 737   
 738  *== adjust employment from 2010 to 2012
 739   
 740   
 741  *parameter tlprop(*,*)  the proportion of total labor supply by year;
 742  parameter bwage(lm)    the average wage of labor by type from micro data i
      n yuan;
 743  parameter bur(lm)     the benchmark unemployment rate ;
 744   
 745   
 746  bwage(lm) =   labordata('wage',lm);
 747  bur(lm)  =   labordata('ul',lm);
 748   
 749  DISPLAY labor_v0,labor_q0,labor_w0,bur,bwage;
 750   
 751  *== set relative wage factor
 752   
 753  parameter fwage_s(i,lm)  factor of average wage among sectors  ;
 754  parameter awage_e(lm)  average wage among education  ;
 755   
 756  awage_e(lm) = sum(i,labor_w0(i,lm)*labor_q0(i,lm))/sum(i,labor_q0(i,lm));
 757   
 758  fwage_s(i,lm) =  labor_w0(i,lm)/awage_e(lm);
 759   
 760   
 761  display fwage_s,awage_e;
 762   
 763   
 764  parameter tlabor_q0(lm)   total employment by sub_labor
 765            tqlabor0       total employment ;
 766   
 767  tlabor_q0(lm)=sum(i,labor_q0(i,lm));
 768  *tlabor0(lm)=fact("labor")*tlprop("2010",lm);
 769  *labor0(i,lm)=tlabor0(lm)*lprop(i,lm)     ;
 770  tqlabor0=sum(lm,tlabor_q0(lm));
 771  display labor_q0,tlabor_q0,tqlabor0;
 772   
 773   
 774  parameter laborelec0,laborist0;
 775  laborelec0(sub_elec,lm)=labor_q0("Elec",lm)*lelec0(sub_elec)/fact0("labor"
      ,"Elec");
 776  laborist0(sub_ist,lm)=list0(sub_ist)*labor_q0("IST",lm)/sum(lmm,labor_q0("
      IST",lmm));
 777   
 778  display laborelec0,laborist0;
 779   
 780  parameter ur0      the benchmark unemployment rate
 781            tlabor_s0(lm)   total labor supply by sub_labor
 782            tqlabor_s0      total labor supply;
 783   
 784  ur0(lm)=bur(lm);
 785  *ur0(lm)=0;
 786   
 787  tlabor_s0(lm)=(tlabor_q0(lm)/(1-ur0(lm)));
 788  tqlabor_s0=sum(lm,tlabor_s0(lm));
 789   
 790  *shock ÀÍ¶¯Á¦¹©¸ø½á¹¹µÄ±ä»¯
 791  *tlabor_s0(lm)=tqlabor_s0*tlprop("2030",lm);
 792   
 793  display ur0,tlabor_s0,tqlabor_s0;
 794   
 795   
          ul unlettered /L1,L8,L15,L22/
          es "elementart school" /L2,L9,L16,L23/
          ms "middle school"     /L3,L10,L17,L24/
          hs "high school"       /L4,L11,L18,L25/
          jc "junior college"    /L5,L12,L19,L26/
          rc "regular college"   /L6,L13,L20,L27/
          pg "postgraduate"      /L7,L14,L21,L28/
          urban    /L1*L7,L15*L21/
          rural    /L8*L14,L22*L28/
          male     /L1*L14/
          femal    /L15*L28/
 809  ;
 810   
 811  *== set for laboe aggregation
 812  set maple(lm,education) map from labor to education/
 813  L1        .        ul
 814  L2        .        es
 815  L3        .        ms
 816  L4        .        hs
 817  L5        .        jc
 818  L6        .        rc
 819  L7        .        pg
 820  L8        .        ul
 821  L9        .        es
 822  L10        .        ms
 823  L11        .        hs
 824  L12        .        jc
 825  L13        .        rc
 826  L14        .        pg
 827  L15        .        ul
 828  L16        .        es
 829  L17        .        ms
 830  L18        .        hs
 831  L19        .        jc
 832  L20        .        rc
 833  L21        .        pg
 834  L22        .        ul
 835  L23        .        es
 836  L24        .        ms
 837  L25        .        hs
 838  L26        .        jc
 839  L27        .        rc
 840  L28        .        pg
 841  /;
 842  set maplr(lm,region) map from labor to region/
 843  L1        .        Urban
 844  L2        .        Urban
 845  L3        .        Urban
 846  L4        .        Urban
 847  L5        .        Urban
 848  L6        .        Urban
 849  L7        .        Urban
 850  L8        .        Rural
 851  L9        .        Rural
 852  L10        .        Rural
 853  L11        .        Rural
 854  L12        .        Rural
 855  L13        .        Rural
 856  L14        .        Rural
 857  L15        .        Urban
 858  L16        .        Urban
 859  L17        .        Urban
 860  L18        .        Urban
 861  L19        .        Urban
 862  L20        .        Urban
 863  L21        .        Urban
 864  L22        .        Rural
 865  L23        .        Rural
 866  L24        .        Rural
 867  L25        .        Rural
 868  L26        .        Rural
 869  L27        .        Rural
 870  L28        .        Rural
 871  /;
 872   
 873  set maplg(lm,gender) map from labor to gender/
 874  L1        .        Male
 875  L2        .        Male
 876  L3        .        Male
 877  L4        .        Male
 878  L5        .        Male
 879  L6        .        Male
 880  L7        .        Male
 881  L8        .        Male
 882  L9        .        Male
 883  L10        .        Male
 884  L11        .        Male
 885  L12        .        Male
 886  L13        .        Male
 887  L14        .        Male
 888  L15        .        Female
 889  L16        .        Female
 890  L17        .        Female
 891  L18        .        Female
 892  L19        .        Female
 893  L20        .        Female
 894  L21        .        Female
 895  L22        .        Female
 896  L23        .        Female
 897  L24        .        Female
 898  L25        .        Female
 899  L26        .        Female
 900  L27        .        Female
 901  L28        .        Female
 902  /;
 903   
 904  set mapll(lm,level) map from labor to level/
 905  L1        .        Low
 906  L2        .        Low
 907  L3        .        Low
 908  L4        .        Low
 909  L5        .        High
 910  L6        .        High
 911  L7        .        High
 912  L8        .        Low
 913  L9        .        Low
 914  L10        .        Low
 915  L11        .        Low
 916  L12        .        High
 917  L13        .        High
 918  L14        .        High
 919  L15        .        Low
 920  L16        .        Low
 921  L17        .        Low
 922  L18        .        Low
 923  L19        .        High
 924  L20        .        High
 925  L21        .        High
 926  L22        .        Low
 927  L23        .        Low
 928  L24        .        Low
 929  L25        .        Low
 930  L26        .        High
 931  L27        .        High
 932  L28        .        High
 933   
 934  /;
 935   
 936   
 937   
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\backstop.gms
 939  *----------------------------------------------*
 940  *backstop technology     2015Äê12ÔÂ3ÈÕ
 941  *----------------------------------------------*
 942  set bt /ngcc,ngcap,igcap/;
 943  parameter active(bt);
 944   
 945  active(bt)=0;
 946  active("ngcap")=0;
 947  active("igcap")=0;
 948  table bsin(bt,*,*)   backstop input structure
 949   
 950                          usa     can     mex     jpn     anz     eur     ro
      e     rus     asi     chn     ind     bra     afr     mes     lam     rea 
          kor     idz
 951  ngcc    .       gas     0.5695  0.5695  0.5695  0.5695  0.5695  0.5695  0.
      5695  0.5695  0.5695  0.5695  0.5695  0.5695  0.5695  0.5695  0.5695  0.56
      95  0.5695  0.5695
 952  ngcc    .       k       0.1611  0.1611  0.1611  0.1611  0.1611  0.1611  0.
      1611  0.1611  0.1611  0.1611  0.1611  0.1611  0.1611  0.1611  0.1611  0.16
      11  0.1611  0.1611
 953  ngcc    .       l       0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.
      0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.03
      96  0.0396  0.0396
 954  ngcc    .       ktd     0.1465  0.1465  0.1465  0.1465  0.1465  0.1465  0.
      1465  0.1465  0.1465  0.1465  0.1465  0.1465  0.1465  0.1465  0.1465  0.14
      65  0.1465  0.1465
 955  ngcc    .       ltd     0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.
      0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.07
      33  0.0733  0.0733
 956  ngcc    .       ffa     0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.
      0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.01
      00  0.0100  0.0100
 957   
 958  ngcap   .       gas     0.4936  0.4936  0.4936  0.4936  0.4936  0.4936  0.
      4936  0.4936  0.4936  0.4936  0.4936  0.4936  0.4936  0.4936  0.4936  0.49
      36  0.4936  0.4936
 959  ngcap   .       k       0.1180  0.1180  0.1180  0.1180  0.1180  0.1180  0.
      1180  0.1180  0.1180  0.1180  0.1180  0.1180  0.1180  0.1180  0.1180  0.11
      80  0.1180  0.1180
 960  ngcap   .       l       0.0290  0.0290  0.0290  0.0290  0.0290  0.0290  0.
      0290  0.0290  0.0290  0.0290  0.0290  0.0290  0.0290  0.0290  0.0290  0.02
      90  0.0290  0.0290
 961  ngcap   .       kseq    0.1670  0.1670  0.1670  0.1670  0.1670  0.1670  0.
      1670  0.1670  0.1670  0.1670  0.1670  0.1670  0.1670  0.1670  0.1670  0.16
      70  0.1670  0.1670
 962  ngcap   .       lseq    0.0213  0.0213  0.0213  0.0213  0.0213  0.0213  0.
      0213  0.0213  0.0213  0.0213  0.0213  0.0213  0.0213  0.0213  0.0213  0.02
      13  0.0213  0.0213
 963  ngcap   .       ktd     0.1074  0.1074  0.1074  0.1074  0.1074  0.1074  0.
      1074  0.1074  0.1074  0.1074  0.1074  0.1074  0.1074  0.1074  0.1074  0.10
      74  0.1074  0.1074
 964  ngcap   .       ltd     0.0537  0.0537  0.0537  0.0537  0.0537  0.0537  0.
      0537  0.0537  0.0537  0.0537  0.0537  0.0537  0.0537  0.0537  0.0537  0.05
      37  0.0537  0.0537
 965  ngcap   .       ffa     0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.
      0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.01
      00  0.0100  0.0100
 966  ngcap   .       frseq   0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.
      9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.90
      00  0.9000  0.9000
 967   
 968  igcap   .       coal    0.1962  0.1962  0.1962  0.1962  0.1962  0.1962  0.
      1962  0.1962  0.1962  0.1962  0.1962  0.1962  0.1962  0.1962  0.1962  0.19
      62  0.1962  0.1962
 969  igcap   .       k       0.2303  0.2303  0.2303  0.2303  0.2303  0.2303  0.
      2303  0.2303  0.2303  0.2303  0.2303  0.2303  0.2303  0.2303  0.2303  0.23
      03  0.2303  0.2303
 970  igcap   .       l       0.0515  0.0515  0.0515  0.0515  0.0515  0.0515  0.
      0515  0.0515  0.0515  0.0515  0.0515  0.0515  0.0515  0.0515  0.0515  0.05
      15  0.0515  0.0515
 971  igcap   .       lseq    0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.
      0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.03
      81  0.0381  0.0381
 972  igcap   .       kseq    0.3237  0.3237  0.3237  0.3237  0.3237  0.3237  0.
      3237  0.3237  0.3237  0.3237  0.3237  0.3237  0.3237  0.3237  0.3237  0.32
      37  0.3237  0.3237
 973  igcap   .       ktd     0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.
      1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.10
      01  0.1001  0.1001
 974  igcap   .       ltd     0.0500  0.0500  0.0500  0.0500  0.0500  0.0500  0.
      0500  0.0500  0.0500  0.0500  0.0500  0.0500  0.0500  0.0500  0.0500  0.05
      00  0.0500  0.0500
 975  igcap   .       ffa     0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.
      0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.0100  0.01
      00  0.0100  0.0100
 976  igcap   .       frseq   0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.
      9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.9000  0.90
      00  0.9000  0.9000
 977  ;
 978   
 979  table  bmkup(bt,*)  backstop markup factor
 980   
 981             usa    can     mex     jpn     anz    eur    roe     rus     as
      i     chn     ind     bra     afr     mes     lam     rea     kor     idz
 982  ngcc     1.058  1.058   1.058   1.058   1.058   1.058   1.058   1.058   1.
      058   1.058   1.058   1.058   1.058   1.058   1.058   1.058   1.058   1.05
      8
 983  ngcap    1.445  1.445   1.445   1.445   1.445   1.445   1.445   1.445   1.
      445   1.445   1.445   1.445   1.445   1.445   1.445   1.445   1.445   1.44
      5
 984  igcap    1.550  1.550   1.550   1.550   1.550   1.550   1.550   1.550   1.
      550   1.550   1.550   1.550   1.550   1.550   1.550   1.550   1.550   1.55
      0
 985   
 986  ;
 987   
 988  table bsf(*,*)  backstop fixed factor substitution elasticity
 989   
 990            USA   CAN     MEX     JPN     ANZ     EUR     ROE     RUS     AS
      I     CHN     IND     BRA     AFR     MES     LAM     REA     KOR     IDZ
 991  ngcc     0.25   0.25    0.25    0.25    0.25    0.25    0.25    0.25    0.
      25    0.20    0.25    0.25    0.25    0.25    0.25    0.25    0.25    0.25
 992  ngcap    0.20   0.20    0.20    0.20    0.20    0.20    0.20    0.20    0.
      20    0.15    0.20    0.20    0.20    0.20    0.20    0.20    0.20    0.20
 993  igcap    0.20   0.20    0.20    0.20    0.20    0.20    0.20    0.20    0.
      20    0.20    0.20    0.20    0.20    0.20    0.20    0.20    0.20    0.20
 994   
 995  ;
 996   
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\core.gms
 998  *----------------------------------------------*
 999  *Core static model    2015/12/9   ¶ÔÉú²úº¯Êý/Ïû·ÑºÍÍ¶×Ê½á¹¹×öÁËÖØÐÂµÄµ÷Õû
1000  *12/15 µçÁ¦ÐÐÒµµÄ½á¹¹È·¶¨Îª    s:0   a:10       b(a):1.5  »¯Ê¯ÄÜÔ´Ö®¼äÏÈÌæ
      ´ú£¬ÔÚÓÚ·Ç»¯Ê¯ÄÜÔ´Ìæ´ú
1001  *12/16   ÐÞ¸Ä½ø¿ÚÙ÷¸³µÄ¹æÄ£²ÎÊý£¬Xscale ±íÊ¾Ã³Ò×Æ½ºâµÄ±ä»¯£¬¶ø·Ç½ø¿Ú¹æÄ£
1002  *É¾¼õ½ø³ö¿ÚºÍ°¢Ã÷¶Ù·½³Ì£¬Ä£ÐÍ¾¡¿ÉÄÜ¼ò»¯
1003  *Ôö¼Ó¹æÄ£ÏµÊýA£¬½áºÏTFPÓÃÒÔ±íÊ¾È«ÒªËØÉú²úÂÊµÄ±ä»¯
1004  *12/20   ÉèÖÃur.loÅÅ³ý=0µÄ¼ÆËã´íÎó   ¼ÙÉè´æÔÚ×ÔÈ»Ê§ÒµÂÊ×÷ÎªÊ§ÒµÂÊµÄ×îÐ¡Öµ£
      ¬È¡ÖµÎªbur("b",lm)£¬À´Ô´ÓÚÊäÈëÊý¾Ý
1005  *12/21   ÐÞÕýl-leµÄÌæ´úµ¯ÐÔ
1006  *        Ôö¼ÓÏµÊýB£¬ÓÃÒÔÃèÊö×ÔÈ»Ê§ÒµÂÊµÄ±ä»¯
1007  *12/25   ÐÞ¸ÄÉú²úº¯Êý½á¹¹£¬½«ÀÍ¶¯Á¦µÄÍ¶Èë·ÅÔÚÒ»Æð£¬¾ÛºÏºóÔÙÓëK»òE×éºÏ
1008  *03/11   ÐÞ¸ÄTFPµÄ×÷ÓÃÎ»ÖÃ£¬Ìí¼Óbaseline calibrationÄ£¿é
1009  *03/25   Îª¿ÉÔÙÉúÄÜÔ´Ôö¼ÓÄÚÉúË°ÂÊÒÔÍâÉúÏÞÖÆÆä·¢µçÁ¿
1010  *03/27   ÔÚ²¹ÌùÄÚÉúµÄÇé¿öÏÂ£¬²»ÔÚ¿¼ÂÇ¹Ì¶¨ÒªËØ¶Ô¿ÉÔÙÉúÄÜÔ´Éú²úµÄÔ¼Êø£¬Ê¹ÓÃÄ
      ÚÉúµÄ²¹Ìù/Ë°ÂÊ£¬Ô¼ÊøµçÁ¦µÄ²úÁ¿
1011  *03/27   ¹Ì¶¨ÒªËØÏÞÖÆË®µçºÍºËµç£¬ºËµçË®µç»ðµç¹¹³Ébase¸ººÉ
1012  *04/05   ÐÞ¸ÄÌ¼ÅÅ·ÅµÄÙ÷¸³£¬Í¨¹ý¸¨Öú±äÁ¿ÉèÖÃÌ¼Ç¿¶È¼õÅÅÄ¿±ê
1013  *04/06   »Ø¸´·Ç»¯Ê¯µçÁ¦µÄ¹Ì¶¨ÒªËØÐèÇó£¬Ôö¼ÓTechnology-specific capital
1014  *0413            1£©ÓÃEPPA6·½·¨ÖØÐÂ²ð·ÖµçÁ¦ÐÐÒµ£¬¿ÉÔÙÉú·¢µç°üº¬ÖÐ¼äÍ¶Èë   
            2£©pe_base     3£©ºÏ²¢ffe
1015   
1016  *----------------------------------------------*
1017  parameter      A                      /1/         ;
1018  parameter      B                      /1/         ;
1019  parameter simu_s,tax_s,re_s;
1020  *simu_s=1,GDPÄÚÉú£»simu_s=0£¬GDPÍâÉú£»
1021  simu_s=1;
1022  *tax_s=1,¿ÉÔÙÉúÄÜÔ´Ë°ÍâÉú£»tax_s=0£¬¿ÉÔÙÉúÄÜÔ´Ë°ÄÚÉú£»
1023  tax_s=1;
1024  re_s=1;
1025   
1026  gprod0=1;
1027   
      $Model:China3E
       
      $Sectors:
      y(i)                   !activity level for domestic production
      consum                 !activity level for aggregate consumption
      invest                 !activity level for aggregate physical capital inve
      stment
      welf                   !activity level for aggregate welfare
      yelec(sub_elec)        !Activity level for electricity production
      *k_a                    !Activity level for capital allocation
      *yist(sub_ist)         !Activity level for ist production
      eb(bt)$active(bt)      !activity level for backstop technology
       
      $Commodities:
      py(i)                  !domestic price inex for goods
      pelec(sub_elec)$(not bse(sub_elec))        !domestic price inex for subele
      c
      pe_base
      pl(lm)
      pk                     !domestic price index for captial demand
      *pk_s                   !domestic price index for captial supply
      *pk_e(sub_elec)$(not TD(sub_elec))              !domestic price index for 
      technology-specific captial
      pffact(i)$x(i)         !domestic price index for fixed factors
      pffelec(sub_elec)$ffelec0(sub_elec)                !domestic price index f
      or fixed factors in electric sector
      pcons                  !price index for aggregate consumption
      pinv                   !price index for aggregate physical capital investm
      ent
      pu                     !price index for utility
       
      *pbf(sub_elec)          !basic factor for installed capacity
       
      pco2$clim
      pco2_s(i)$clim_s(i)              !shadow value of cafbon
      pco2_h$clim_h
      PSO2$slim              !shadow value of sulfur
       
      $consumers:
      ra                     !income level for representative agent
       
      $auxiliary:
      sff(x)$ffact0(x)       !side constraint modelling supply of fixed factor
      sffelec(sub_elec)$ffelec0(sub_elec)         !side constraint modelling sup
      ply of fixed factors
      ur(lm)$ur0(lm)                 !unemployment rate
      rgdp                     !real gdp
      gprod                    !productivity index
      gprod1                     !productivity index
      gprod3                     !productivity index
      gprod2(lm)$ur0(lm)                    !productivity index
      t_re(sub_elec)$ret0(sub_elec)               !ÄÚÉúµÄÄÜÔ´²¹Ìù
      tclim$clim                     ! carbon limit
       
      *$prod:k_a   t:1
      *        o:pk                                q:(sum(i,fact0("capital",i))-
      fact0("capital","elec")+kelec0("T_D"))
      *        o:pk_e(sub_elec)$(not TD(sub_elec)) q:(kelec0(sub_elec)*emkup(sub
      _elec))
      *        i:pk_s                              q:fact("capital")
       
       
       
      $prod:y(i)$elec(i)   s:0   a:10      b(a):enesta
              o:py(i)                               q:output0(i)
              i:pelec(sub_elec)$TD(sub_elec)        q:outputelec0(sub_elec)
              i:pelec(sub_elec)$wse(sub_elec)       q:outputelec0(sub_elec)     
        a:
              i:pe_base                             q:(sum(bse,outputelec0(bse))
      )       a:
       
      *        i:pelec(sub_elec)$wse(sub_elec)       q:outputelec0(sub_elec)    
         a:
      *        i:pelec(sub_elec)$hnb(sub_elec)       q:outputelec0(sub_elec)    
         a:
      *        i:pelec(sub_elec)$ffe(sub_elec)       q:outputelec0(sub_elec)    
         b:
       
      *       Production of T&D electricity
      $prod:yelec(sub_elec)$TD(sub_elec) s:0       l(s):eslm("l")
              o:pelec(sub_elec)        q:(outputelec0(sub_elec))              p:
      (1-taxelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
              i:py(i)$(not e(i))       q:intelec0(i,sub_elec)
              i:py(elec)               q:(intelec0(elec,sub_elec)*aeei("elec"))
              i:py(fe)                 q:(intelec0(fe,sub_elec)*aeei("elec"))
              i:pl(lm)$ll(lm)          q:laborelec0(sub_elec,lm)            P:wa
      ge("0.11",lm)        l:
              i:pl(lm)$hl(lm)          q:laborelec0(sub_elec,lm)            P:wa
      ge("0.11",lm)        l:
              i:pk                     q:kelec0(sub_elec)
       
      *       Production of fossile fuel electricity
      *sub_sector Í¶ÈëµÄÌæ´úµ¯ÐÔÓ¦¸ÃÐ¡ÓÚÔ­sector
      $prod:yelec(sub_elec)$ffe(sub_elec) s:0   kle(s):0.4 kl(kle):0.6 l(kl):esl
      m("l")   ene(kle):enesta roil(ene):0 coal(ene):0 gas(ene):0
      *        o:pelec(sub_elec)        Q:outputelec0(sub_elec)           a:ra  
      N:t_re(sub_elec)
              o:pe_base        q:(outputelec0(sub_elec))                 p:(1-ta
      xelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
              i:py(i)$(not e(i))       q:(intelec0(i,sub_elec)*emkup(sub_elec))
              i:py(elec)               q:(intelec0(elec,sub_elec)*aeei("elec")*e
      mkup(sub_elec))
              i:pl(lm)$ll(lm)          q:(laborelec0(sub_elec,lm)*emkup(sub_elec
      ))               P:wage("0.11",lm)   l:
              i:pl(lm)$hl(lm)          q:(laborelec0(sub_elec,lm)*emkup(sub_elec
      ))               P:wage("0.11",lm)   l:
              i:pk                     q:(kelec0(sub_elec)*emkup(sub_elec))     
                          kl:
              i:py(fe)$intelec0(fe,sub_elec)    q:(intelec0(fe,sub_elec)*aeei("e
      lec")*emkup(sub_elec))                            fe.tl:
              i:pco2#(fe)$clim         q:(emission0("co2","e",fe,sub_elec)*aeei(
      "elec")*emkup(sub_elec))      p:1e-5             fe.tl:
              i:pco2_s("elec")#(fe)$clim_s("elec")         q:(emission0("co2","e
      ",fe,sub_elec)*aeei("elec")*emkup(sub_elec))      p:1e-5             fe.tl
      :
              I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,sub_elec)*aeei(
      "elec")*emkup(sub_elec))      P:1e-5         fe.tl:
       
       
      *       Production of hybro and nuclear biomass electricity      va2 from 
      wang ke
      $prod:yelec(sub_elec)$hnb(sub_elec)  s:esub(sub_elec,"ff") a:0 va(a):esub(
      "elec","kl") l(va):eslm("l")
              o:pe_base                q:outputelec0(sub_elec)              a:ra
        N:t_re(sub_elec)
      *        o:pelec(sub_elec)       q:(outputelec0(sub_elec))                
       p:(1-taxelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
              i:py(i)                  q:(intelec0(i,sub_elec)*emkup(sub_elec)) 
                                                   a:
              i:pl(lm)$ll(lm)          q:(laborelec0(sub_elec,lm)*emkup(sub_elec
      ))              P:wage("0.11",lm)            l:
              i:pl(lm)$hl(lm)          q:(laborelec0(sub_elec,lm)*emkup(sub_elec
      ))              P:wage("0.11",lm)            l:
              i:pk                     q:(kelec0(sub_elec)*emkup(sub_elec))     
                                                   va:
              i:pffelec(sub_elec)$ffelec0(sub_elec)                q:(ffelec0(su
      b_elec)*emkup(sub_elec))      P:1
       
      *       Production of wind, solar  electricity      va2 from wang ke
      $prod:yelec(sub_elec)$wse(sub_elec) s:esub(sub_elec,"ff") b:0 va(b):esub("
      elec","kl") l(va):eslm("l")
              o:pelec(sub_elec)        q:(outputelec0(sub_elec))                
         a:ra  N:t_re(sub_elec)
      *        o:pelec(sub_elec)       q:(outputelec0(sub_elec))                
       p:(1-taxelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
              i:py(i)                  q:(intelec0(i,sub_elec)*emkup(sub_elec)) 
                                                   b:
              i:pl(lm)$ll(lm)          q:(laborelec0(sub_elec,lm)*emkup(sub_elec
      ))              P:wage("0.11",lm)            l:
              i:pl(lm)$hl(lm)          q:(laborelec0(sub_elec,lm)*emkup(sub_elec
      ))              P:wage("0.11",lm)            l:
              i:pk                     q:(kelec0(sub_elec)*emkup(sub_elec))     
                                                   va:
              i:pffelec(sub_elec)$ffelec0(sub_elec)                q:(ffelec0(su
      b_elec)*emkup(sub_elec))      P:1
       
       
      $prod:y(i)$(not fe(i) and not elec(i) ) s:0 a:esub(i,"ff") b(a):0  kle(b):
      0.4 kl(kle):0.6  l(kl):eslm("l") e(kle):sigma("ele_p") ne(e):sigma("ene_p"
      )  coal(ne):0 roil(ne):0 gas(ne):0
              o:py(i)                  q:(output0(i))                    p:(1-tx
      0(i))     a:ra    t:tx0(i)
              I:PSO2$slim              Q:emission0("so2","e","process",i)       
       P:1e-5
              i:pffact(i)$ffact0(i)    q:ffact0(i)                              
                   a:
              i:py(j)$(not e(j))       q:int0(j,i)                              
                 b:
              i:pk                     q:fact0("capital",i)                     
               kl:
              i:pl(lm)$ll(lm)          q:labor0(i,lm)             P:wage("0.11",
      lm)             l:
              i:pl(lm)$hl(lm)          q:labor0(i,lm)             P:wage("0.11",
      lm)             l:
              i:py(elec)               q:(int0(elec,i)*aeei(i))                 
               e:
              i:py(fe)                 q:(int0(fe,i)*aeei(i))                   
               fe.tl:
              i:pco2#(fe)$clim         q:(emission0("co2","e",fe,i)*aeei(i))    
        p:1e-5             fe.tl:
              i:pco2_s(i)#(fe)$clim_s(i)         q:(emission0("co2","e",fe,i)*ae
      ei(i))      p:1e-5             fe.tl:
              I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,i)*aeei(i))    
        P:1e-5              fe.tl:
       
       
      *       Production of fossil fuel production       va from wang ke
      $prod:y(i)$fe(i) s:0 a:esub(i,"ff") b(a):0 va(b):esub(i,"kl") l(va):eslm("
      l")  coal(b):0 roil(b):0 gas(b):0
              o:py(i)                  q:(output0(i))                    p:(1-tx
      0(i))     a:ra    t:tx0(i)
              I:PSO2$slim              Q:emission0("so2","e","process",i)       
       P:1e-5
              i:py(j)$(not fe(j))      q:int0(j,i)                              
             b:
              i:pk                     q:fact0("capital",i)            va:
              i:pl(lm)$ll(lm)          q:labor0(i,lm)        P:wage("0.11",lm)  
              l:
              i:pl(lm)$hl(lm)          q:labor0(i,lm)        P:wage("0.11",lm)  
              l:
              i:pffact(i)$ffact0(i)    q:ffact0(i)                              
              a:
              i:py(fe)                 q:(int0(fe,i)*aeei(i))                   
               fe.tl:
              i:pco2#(fe)$clim         q:(emission0("co2","e",fe,i)*aeei(i))    
        p:1e-5             fe.tl:
              i:pco2_s(i)#(fe)$clim_s(i)         q:(emission0("co2","e",fe,i)*ae
      ei(i))      p:1e-5             fe.tl:
              I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,i)*aeei(i))    
        P:1e-5              fe.tl:
       
       
       
      *        consumption of goods and factors    ½á¹¹²ÎÕÕEPPA
       
      $prod:consum   s:esub_c  a:0.3 e:sigma("ene_fd") roil(e):0 coal(e):0 gas(e
      ):0
               o:pcons                  q:(sum(i,cons0(i))+sum(f,consf0(f)))
               i:py(i)$(not e(i))       q:cons0(i)                a:
               i:py(i)$(elec(i))        q:(cons0(i)*aeei("fd"))                e
      :
               i:py(fe)                 q:(cons0(fe)*aeei("fd"))                
       fe.tl:
               i:pco2#(fe)$clim         q:(emission0("co2","e",fe,"household")*a
      eei("fd"))      p:1e-5             fe.tl:
               i:pco2_h#(fe)$clim_h     q:(emission0("co2","e",fe,"household")*a
      eei("fd"))      p:1e-5           fe.tl:
               I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,"household")*a
      eei("fd"))      P:1e-5         fe.tl:
       
       
      *        aggregate capital investment
       
      $prod:invest   s:esub_inv
               o:pinv             q:(sum(i,inv0(i)))
               i:py(i)            q:inv0(i)
       
       
       
      *        welfare          Íõ¿Ë EPPA S£ºÈ¡Öµ¶¼Îª1
       
      $prod:welf    s:1.0
               o:pu                 q:(sum(i,cons0(i)+inv0(i))+sum(f,consf0(f)+i
      nvf0(f)))
               i:pcons              q:(sum(i,cons0(i))+sum(f,consf0(f)))
               i:pinv               q:(sum(i,inv0(i))+sum(f,invf0(f)))
       
       
      $demand:ra
       
      *demand for consumption,invest and rd
       
      d:pu                 q:(sum(i,cons0(i)+inv0(i))+sum(f,consf0(f)+invf0(f)))
       
      *endowment of factor supplies
       
      e:pk                 q:fact("capital")                                    
           r:gprod
      e:pk                 q:(-1)                   r:gprod1
      e:pk                 q:1                      r:gprod3
      e:pl(lm)             q:(tlabor_s0(lm))                                    
           r:gprod
      e:pl(lm)$ur0(lm)     q:((-tlabor_s0(lm)))                                 
           r:gprod2(lm)
       
      e:pffact(x)          q:ffact0(x)                 r:sff(x)$ffact0(x)
      e:pffelec(sub_elec)$ffelec0(sub_elec)           q:(ffelec0(sub_elec)*emkup
      0(sub_elec))         r:sffelec(sub_elec)
       
      *exogenous endowment of net exports(include variances)
       
      e:py(i)              q:(-(nx0(i)+xinv0(i)+xcons0(i))*xscale)
       
      *endowment of carbon emission allowances
       
      e:pco2$clim         q:1                        r:tclim
       
      e:pco2_s(i)$clim_s(i)    q:clim_s(i)
      e:pco2_h$clim_h      q:clim_h
      e:pso2$slim          q:slim
       
      *supplement benchmark fixed-factor endowments according to assumed price e
      lasticities of resource supply
       
      $constraint:sff(x)$ffact0(x)
      *      sff(x)    =e= (pffact(x)/pu)**eta(x);
           sff(x)    =e= (py(x)/pu)**eta(x);
       
      *$constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and hne(sub_elec))
      *         sffelec(sub_elec) =e=  sffelec0(sub_elec);
       
      $constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and simu_s eq 0)
      *          sffelec(sub_elec) =e=  sffelec0(sub_elec);
               yelec(sub_elec) =e=ret0(sub_elec);
       
      $constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and simu_s eq 1 and re_s 
      eq 1)
      *         sffelec(sub_elec) =e=  sffelec1(sub_elec);
                sffelec(sub_elec) =e=  sffelec0(sub_elec);
      $constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and simu_s eq 1 and re_s 
      eq 0)
                yelec(sub_elec) =e=ret0(sub_elec);
       
       
       
      *»ù×¼Çé¾°£¬Ë°/²¹ÌùÍâÉú
      $constraint:t_re(sub_elec)$(ret0(sub_elec) and tax_s eq 1)
              t_re(sub_elec) =e=taxelec0(sub_elec);
       
       
      *Õþ²ßÇé¾°£¬Ë°/²¹ÌùÄÚÉú
      $constraint:t_re(sub_elec)$(wsb(sub_elec) and tax_s ne 1)
              yelec(sub_elec) =e=ret0(sub_elec);
       
      $constraint:t_re(sub_elec)$(hne(sub_elec) and tax_s ne 1)
              yelec(sub_elec) =e=ret0(sub_elec);
       
      $constraint:ur(lm)$ur0(lm)
            (Pl(lm)/pu)/(wage("0.11",lm)/pu) =E=(ur(lm)/ur0(lm))**(-0.1);
      *     ur0(lm)*(Pl(lm)/wage("0.11",lm))**(-1/10) =e=ur(lm);
       
      $constraint:gprod1$(simu_s ne 0)
         gprod1 =e= gprod0*sum(sub_elec,sffelec(sub_elec)*ffelec0(sub_elec)*emku
      p0(sub_elec)*pffelec(sub_elec)/pk);
       
      $constraint:gprod1$(simu_s eq 0)
         gprod1 =e= gprod*sum(sub_elec,sffelec(sub_elec)*ffelec0(sub_elec)*emkup
      0(sub_elec)*pffelec(sub_elec)/pk);
       
      $constraint:gprod3$(simu_s ne 0)
      *  gprod3 =e= gprod0*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_elec)*emk
      up0(sub_elec)*pffelec(sub_elec)/pk);
         gprod3 =e= gprod0*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_elec)*emk
      up0(sub_elec)*pffelec(sub_elec)/pk);
       
      $constraint:gprod3$(simu_s eq 0)
      *  gprod3 =e= gprod*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_elec)*emku
      p0(sub_elec)*pffelec(sub_elec)/pk);
         gprod3 =e= gprod*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_elec)*emku
      p0(sub_elec)*pffelec(sub_elec)/pk);
       
       
       
      $constraint:gprod2(lm)$(ur0(lm) and simu_s ne 0)
        gprod2(lm) =e= gprod0*ur(lm);
       
      $constraint:gprod2(lm)$(ur0(lm) and simu_s eq 0)
       gprod2(lm) =e= gprod*ur(lm);
       
      $constraint:rgdp
        pu*rgdp =e= pcons*(sum(i,cons0(i))+sum(f,consf0(f)))*consum+pinv*(sum(i,
      inv0(i)))*invest+sum(i,py(i)*((nx0(i)+xinv0(i)+xcons0(i))*xscale))   ;
       
      $constraint:gprod$(simu_s eq 0)
        rgdp =e= rgdp0;
       
      $constraint:gprod$(simu_s ne 0)
        gprod =e= gprod0;
       
      $constraint:tclim$clim
      *×ÜÁ¿Ä¿±ê
      *   tclim =e= clim0*temission2("co2");
       
        tclim =e= clim0*temission2("co2")/rgdp0*rgdp;
       
      $report:
       
      v:qdout(j)             o:py(j)       prod:y(j)     !output by sector(domes
      tic market)
       
      v:qc(i)                i:py(i)       prod:consum   !consumpiton of final c
      ommodities
      v:grosscons            o:pcons       prod:consum   !aggregate consumpiton
       
      v:qinvk(i)             i:py(i)       prod:invest   !physical capital inves
      tment by non-energy sectors
      v:grossinvk            o:pinv        prod:invest   !aggregate physical cap
      ital investment
       
       
      v:util                 o:pu          prod:welf       !welf
       
      v:qin(i,j)             i:py(i)       prod:y(j)      !inputs of intermediat
      e goods
      v:qin_ele(i,sub_elec)  i:py(i)       prod:yelec(sub_elec)      !inputs of 
      intermediate goods to fossil fuel fired generation
       
      v:qkin(j)              i:pk          prod:y(j)        !capital inputs
      *v:qkein(sub_elec)$(not TD(sub_elec))                o:pk_e(sub_elec)     
         prod:yelec(sub_elec)   !capital inputs
      *v:qkt                  i:pk_s        prod:k_a         !capital supply
      *v:qk                   o:pk          prod:k_a        !capital inputs
      *v:qke(sub_elec)$(not TD(sub_elec))                o:pk_e(sub_elec)       
       prod:k_a        !capital inputs
       
      v:qlin(lm,j)           i:pl(lm)      prod:y(j)        !labor inputs
      v:qlin_ele(lm,sub_elec)      i:pl(lm)      prod:yelec(sub_elec)        !la
      bor inputs
      v:qkin_ele(sub_elec)   i:pk          prod:yelec(sub_elec)        !capital 
      inputs
      v:qffin(j)$x(j)        i:pffact(j)   prod:y(j)        !fixed factor inputs
       
      v:qffelec(sub_elec)$ffelec0(sub_elec)    i:pffelec(sub_elec)     prod:yele
      c(sub_elec)      !fixed factor inputs
       
      V:qelec1(sub_elec)$(not wse(sub_elec))        o:pe_base       prod:yelec(s
      ub_elec)
      V:qelec2(sub_elec)$(wse(sub_elec))            o:pelec(sub_elec)           
          prod:yelec(sub_elec)
       
      v:ECO2(i)              i:pco2         prod:y(i)
      v:ECO2_s(i)              i:pco2_s(i)        prod:y(i)
      v:ECO2_e(sub_elec)     i:pco2       prod:yelec(sub_elec)
      v:eco2_h               i:pco2        prod:consum
      v:EsO2(i)              i:pso2        prod:y(i)
      v:EHsO2                i:pso2        prod:consum
SYSINCLUDE C:\GAMS\win64\24.4\mpsgeset
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\225a\gamsgeh.dat
1561        (PL(LM)/PU)/(WAGE("0.11",LM)/PU) =E=(UR(LM)/UR0(LM))**(-0.1);
****                        $140
**** LINE    199 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\225a\
                             gamsgeh.dat
**** LINE     20 SYSINCLUDE  C:\GAMS\win64\24.4\mpsgeset
                             %1  China3E
**** LINE    345 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\core.
                             gms
**** LINE     13 INPUT       C:\Users\hero\Desktop\Github\test model - V17\run.g
                             ms
       
      MPSGE PREPROCESSOR VERSION 12/95
          1
          2  $Sectors:
          3  y(i)                   !activity level for domestic production
          4  consum                 !activity level for aggregate consumption
          5  invest                 !activity level for aggregate physical capit
      al investment
          6  welf                   !activity level for aggregate welfare
          7  yelec(sub_elec)        !Activity level for electricity production
          8  *k_a                    !Activity level for capital allocation
          9  *yist(sub_ist)         !Activity level for ist production
         10  eb(bt)$active(bt)      !activity level for backstop technology
         11
         12  $Commodities:
         13  py(i)                  !domestic price inex for goods
         14  pelec(sub_elec)$(not bse(sub_elec))        !domestic price inex for
       subelec
         15  pe_base
         16  pl(lm)
         17  pk                     !domestic price index for captial demand
         18  *pk_s                   !domestic price index for captial supply
         19  *pk_e(sub_elec)$(not TD(sub_elec))              !domestic price ind
      ex for technology-specific captial
         20  pffact(i)$x(i)         !domestic price index for fixed factors
         21  pffelec(sub_elec)$ffelec0(sub_elec)                !domestic price 
      index for fixed factors in electric sector
         22  pcons                  !price index for aggregate consumption
         23  pinv                   !price index for aggregate physical capital 
      investment
         24  pu                     !price index for utility
         25
         26  *pbf(sub_elec)          !basic factor for installed capacity
         27
         28  pco2$clim
         29  pco2_s(i)$clim_s(i)              !shadow value of cafbon
         30  pco2_h$clim_h
         31  PSO2$slim              !shadow value of sulfur
         32
         33  $consumers:
         34  ra                     !income level for representative agent
         35
         36  $auxiliary:
         37  sff(x)$ffact0(x)       !side constraint modelling supply of fixed f
      actor
         38  sffelec(sub_elec)$ffelec0(sub_elec)         !side constraint modell
      ing supply of fixed factors
         39  ur(lm)$ur0(lm)                 !unemployment rate
         40  rgdp                     !real gdp
         41  gprod                    !productivity index
         42  gprod1                     !productivity index
         43  gprod3                     !productivity index
         44  gprod2(lm)$ur0(lm)                    !productivity index
         45  t_re(sub_elec)$ret0(sub_elec)               !ÄÚÉúµÄÄÜÔ´²¹Ìù
         46  tclim$clim                     ! carbon limit
         47
         48  *$prod:k_a   t:1
         49  *        o:pk                                q:(sum(i,fact0("capita
      l",i))-fact0("capital","elec")+kelec0("T_D"))
         50  *        o:pk_e(sub_elec)$(not TD(sub_elec)) q:(kelec0(sub_elec)*em
      kup(sub_elec))
         51  *        i:pk_s                              q:fact("capital")
         52
         53
         54
         55  $prod:y(i)$elec(i)   s:0   a:10      b(a):enesta
         56          o:py(i)                               q:output0(i)
         57          i:pelec(sub_elec)$TD(sub_elec)        q:outputelec0(sub_ele
      c)
         58          i:pelec(sub_elec)$wse(sub_elec)       q:outputelec0(sub_ele
      c)       a:
         59          i:pe_base                             q:(sum(bse,outputelec
      0(bse)))       a:
         60
         61  *        i:pelec(sub_elec)$wse(sub_elec)       q:outputelec0(sub_el
      ec)       a:
         62  *        i:pelec(sub_elec)$hnb(sub_elec)       q:outputelec0(sub_el
      ec)       a:
         63  *        i:pelec(sub_elec)$ffe(sub_elec)       q:outputelec0(sub_el
      ec)       b:
         64
         65  *       Production of T&D electricity
         66  $prod:yelec(sub_elec)$TD(sub_elec) s:0       l(s):eslm("l")
         67          o:pelec(sub_elec)        q:(outputelec0(sub_elec))         
           p:(1-taxelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
         68          i:py(i)$(not e(i))       q:intelec0(i,sub_elec)
         69          i:py(elec)               q:(intelec0(elec,sub_elec)*aeei("e
      lec"))
         70          i:py(fe)                 q:(intelec0(fe,sub_elec)*aeei("ele
      c"))
         71          i:pl(lm)$ll(lm)          q:laborelec0(sub_elec,lm)         
         P:wage("0.11",lm)        l:
         72          i:pl(lm)$hl(lm)          q:laborelec0(sub_elec,lm)         
         P:wage("0.11",lm)        l:
         73          i:pk                     q:kelec0(sub_elec)
         74
         75  *       Production of fossile fuel electricity
         76  *sub_sector Í¶ÈëµÄÌæ´úµ¯ÐÔÓ¦¸ÃÐ¡ÓÚÔ­sector
         77  $prod:yelec(sub_elec)$ffe(sub_elec) s:0   kle(s):0.4 kl(kle):0.6 l(
      kl):eslm("l")   ene(kle):enesta roil(ene):0 coal(ene):0 gas(ene):0
         78  *        o:pelec(sub_elec)        Q:outputelec0(sub_elec)          
       a:ra  N:t_re(sub_elec)
         79          o:pe_base        q:(outputelec0(sub_elec))                 
      p:(1-taxelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
         80          i:py(i)$(not e(i))       q:(intelec0(i,sub_elec)*emkup(sub_
      elec))
         81          i:py(elec)               q:(intelec0(elec,sub_elec)*aeei("e
      lec")*emkup(sub_elec))
         82          i:pl(lm)$ll(lm)          q:(laborelec0(sub_elec,lm)*emkup(s
      ub_elec))               P:wage("0.11",lm)   l:
         83          i:pl(lm)$hl(lm)          q:(laborelec0(sub_elec,lm)*emkup(s
      ub_elec))               P:wage("0.11",lm)   l:
         84          i:pk                     q:(kelec0(sub_elec)*emkup(sub_elec
      ))                         kl:
         85          i:py(fe)$intelec0(fe,sub_elec)    q:(intelec0(fe,sub_elec)*
      aeei("elec")*emkup(sub_elec))                            fe.tl:
         86          i:pco2#(fe)$clim         q:(emission0("co2","e",fe,sub_elec
      )*aeei("elec")*emkup(sub_elec))      p:1e-5             fe.tl:
         87          i:pco2_s("elec")#(fe)$clim_s("elec")         q:(emission0("
      co2","e",fe,sub_elec)*aeei("elec")*emkup(sub_elec))      p:1e-5           
        fe.tl:
         88          I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,sub_elec
      )*aeei("elec")*emkup(sub_elec))      P:1e-5         fe.tl:
         89
         90
         91  *       Production of hybro and nuclear biomass electricity      va
      2 from wang ke
         92  $prod:yelec(sub_elec)$hnb(sub_elec)  s:esub(sub_elec,"ff") a:0 va(a
      ):esub("elec","kl") l(va):eslm("l")
         93          o:pe_base                q:outputelec0(sub_elec)           
         a:ra  N:t_re(sub_elec)
         94  *        o:pelec(sub_elec)       q:(outputelec0(sub_elec))         
              p:(1-taxelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
         95          i:py(i)                  q:(intelec0(i,sub_elec)*emkup(sub_
      elec))                                              a:
         96          i:pl(lm)$ll(lm)          q:(laborelec0(sub_elec,lm)*emkup(s
      ub_elec))              P:wage("0.11",lm)            l:
         97          i:pl(lm)$hl(lm)          q:(laborelec0(sub_elec,lm)*emkup(s
      ub_elec))              P:wage("0.11",lm)            l:
         98          i:pk                     q:(kelec0(sub_elec)*emkup(sub_elec
      ))                                                  va:
         99          i:pffelec(sub_elec)$ffelec0(sub_elec)                q:(ffe
      lec0(sub_elec)*emkup(sub_elec))      P:1
        100
        101  *       Production of wind, solar  electricity      va2 from wang k
      e
        102  $prod:yelec(sub_elec)$wse(sub_elec) s:esub(sub_elec,"ff") b:0 va(b)
      :esub("elec","kl") l(va):eslm("l")
        103          o:pelec(sub_elec)        q:(outputelec0(sub_elec))         
                a:ra  N:t_re(sub_elec)
        104  *        o:pelec(sub_elec)       q:(outputelec0(sub_elec))         
              p:(1-taxelec0(sub_elec))  a:ra  t:taxelec0(sub_elec)
        105          i:py(i)                  q:(intelec0(i,sub_elec)*emkup(sub_
      elec))                                              b:
        106          i:pl(lm)$ll(lm)          q:(laborelec0(sub_elec,lm)*emkup(s
      ub_elec))              P:wage("0.11",lm)            l:
        107          i:pl(lm)$hl(lm)          q:(laborelec0(sub_elec,lm)*emkup(s
      ub_elec))              P:wage("0.11",lm)            l:
        108          i:pk                     q:(kelec0(sub_elec)*emkup(sub_elec
      ))                                                  va:
        109          i:pffelec(sub_elec)$ffelec0(sub_elec)                q:(ffe
      lec0(sub_elec)*emkup(sub_elec))      P:1
        110
        111
        112  $prod:y(i)$(not fe(i) and not elec(i) ) s:0 a:esub(i,"ff") b(a):0  
      kle(b):0.4 kl(kle):0.6  l(kl):eslm("l") e(kle):sigma("ele_p") ne(e):sigma(
      "ene_p")  coal(ne):0 roil(ne):0 gas(ne):0
        113          o:py(i)                  q:(output0(i))                    
      p:(1-tx0(i))     a:ra    t:tx0(i)
        114          I:PSO2$slim              Q:emission0("so2","e","process",i)
              P:1e-5
        115          i:pffact(i)$ffact0(i)    q:ffact0(i)                       
                          a:
        116          i:py(j)$(not e(j))       q:int0(j,i)                       
                        b:
        117          i:pk                     q:fact0("capital",i)              
                      kl:
        118          i:pl(lm)$ll(lm)          q:labor0(i,lm)             P:wage(
      "0.11",lm)             l:
        119          i:pl(lm)$hl(lm)          q:labor0(i,lm)             P:wage(
      "0.11",lm)             l:
        120          i:py(elec)               q:(int0(elec,i)*aeei(i))          
                      e:
        121          i:py(fe)                 q:(int0(fe,i)*aeei(i))            
                      fe.tl:
        122          i:pco2#(fe)$clim         q:(emission0("co2","e",fe,i)*aeei(
      i))      p:1e-5             fe.tl:
        123          i:pco2_s(i)#(fe)$clim_s(i)         q:(emission0("co2","e",f
      e,i)*aeei(i))      p:1e-5             fe.tl:
        124          I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,i)*aeei(
      i))      P:1e-5              fe.tl:
        125
        126
        127  *       Production of fossil fuel production       va from wang ke
        128  $prod:y(i)$fe(i) s:0 a:esub(i,"ff") b(a):0 va(b):esub(i,"kl") l(va)
      :eslm("l")  coal(b):0 roil(b):0 gas(b):0
        129          o:py(i)                  q:(output0(i))                    
      p:(1-tx0(i))     a:ra    t:tx0(i)
        130          I:PSO2$slim              Q:emission0("so2","e","process",i)
              P:1e-5
        131          i:py(j)$(not fe(j))      q:int0(j,i)                       
                    b:
        132          i:pk                     q:fact0("capital",i)            va
      :
        133          i:pl(lm)$ll(lm)          q:labor0(i,lm)        P:wage("0.11
      ",lm)          l:
        134          i:pl(lm)$hl(lm)          q:labor0(i,lm)        P:wage("0.11
      ",lm)          l:
        135          i:pffact(i)$ffact0(i)    q:ffact0(i)                       
                     a:
        136          i:py(fe)                 q:(int0(fe,i)*aeei(i))            
                      fe.tl:
        137          i:pco2#(fe)$clim         q:(emission0("co2","e",fe,i)*aeei(
      i))      p:1e-5             fe.tl:
        138          i:pco2_s(i)#(fe)$clim_s(i)         q:(emission0("co2","e",f
      e,i)*aeei(i))      p:1e-5             fe.tl:
        139          I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,i)*aeei(
      i))      P:1e-5              fe.tl:
        140
        141
        142
        143  *        consumption of goods and factors    ½á¹¹²ÎÕÕEPPA
        144
        145  $prod:consum   s:esub_c  a:0.3 e:sigma("ene_fd") roil(e):0 coal(e):
      0 gas(e):0
        146           o:pcons                  q:(sum(i,cons0(i))+sum(f,consf0(f
      )))
        147           i:py(i)$(not e(i))       q:cons0(i)                a:
        148           i:py(i)$(elec(i))        q:(cons0(i)*aeei("fd"))          
            e:
        149           i:py(fe)                 q:(cons0(fe)*aeei("fd"))         
              fe.tl:
        150           i:pco2#(fe)$clim         q:(emission0("co2","e",fe,"househ
      old")*aeei("fd"))      p:1e-5             fe.tl:
        151           i:pco2_h#(fe)$clim_h     q:(emission0("co2","e",fe,"househ
      old")*aeei("fd"))      p:1e-5           fe.tl:
        152           I:PSO2#(fe)$slim         Q:(emission0("so2","e",fe,"househ
      old")*aeei("fd"))      P:1e-5         fe.tl:
        153
        154
        155  *        aggregate capital investment
        156
        157  $prod:invest   s:esub_inv
        158           o:pinv             q:(sum(i,inv0(i)))
        159           i:py(i)            q:inv0(i)
        160
        161
        162
        163  *        welfare          Íõ¿Ë EPPA S£ºÈ¡Öµ¶¼Îª1
        164
        165  $prod:welf    s:1.0
        166           o:pu                 q:(sum(i,cons0(i)+inv0(i))+sum(f,cons
      f0(f)+invf0(f)))
        167           i:pcons              q:(sum(i,cons0(i))+sum(f,consf0(f)))
        168           i:pinv               q:(sum(i,inv0(i))+sum(f,invf0(f)))
        169
        170
        171  $demand:ra
        172
        173  *demand for consumption,invest and rd
        174
        175  d:pu                 q:(sum(i,cons0(i)+inv0(i))+sum(f,consf0(f)+inv
      f0(f)))
        176
        177  *endowment of factor supplies
        178
        179  e:pk                 q:fact("capital")                             
                  r:gprod
        180  e:pk                 q:(-1)                   r:gprod1
        181  e:pk                 q:1                      r:gprod3
        182  e:pl(lm)             q:(tlabor_s0(lm))                             
                  r:gprod
        183  e:pl(lm)$ur0(lm)     q:((-tlabor_s0(lm)))                          
                  r:gprod2(lm)
        184
        185  e:pffact(x)          q:ffact0(x)                 r:sff(x)$ffact0(x)
        186  e:pffelec(sub_elec)$ffelec0(sub_elec)           q:(ffelec0(sub_elec
      )*emkup0(sub_elec))         r:sffelec(sub_elec)
        187
        188  *exogenous endowment of net exports(include variances)
        189
        190  e:py(i)              q:(-(nx0(i)+xinv0(i)+xcons0(i))*xscale)
        191
        192  *endowment of carbon emission allowances
        193
        194  e:pco2$clim         q:1                        r:tclim
        195
        196  e:pco2_s(i)$clim_s(i)    q:clim_s(i)
        197  e:pco2_h$clim_h      q:clim_h
        198  e:pso2$slim          q:slim
        199
        200  *supplement benchmark fixed-factor endowments according to assumed 
      price elasticities of resource supply
        201
        202  $constraint:sff(x)$ffact0(x)
        203  *      sff(x)    =e= (pffact(x)/pu)**eta(x);
        204       sff(x)    =e= (py(x)/pu)**eta(x);
        205
        206  *$constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and hne(sub_elec)
      )
        207  *         sffelec(sub_elec) =e=  sffelec0(sub_elec);
        208
        209  $constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and simu_s eq 0)
        210  *          sffelec(sub_elec) =e=  sffelec0(sub_elec);
        211           yelec(sub_elec) =e=ret0(sub_elec);
        212
        213  $constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and simu_s eq 1 an
      d re_s eq 1)
        214  *         sffelec(sub_elec) =e=  sffelec1(sub_elec);
        215            sffelec(sub_elec) =e=  sffelec0(sub_elec);
        216  $constraint:sffelec(sub_elec)$(ffelec0(sub_elec) and simu_s eq 1 an
      d re_s eq 0)
        217            yelec(sub_elec) =e=ret0(sub_elec);
        218
        219
        220
        221  *»ù×¼Çé¾°£¬Ë°/²¹ÌùÍâÉú
        222  $constraint:t_re(sub_elec)$(ret0(sub_elec) and tax_s eq 1)
        223          t_re(sub_elec) =e=taxelec0(sub_elec);
        224
        225
        226  *Õþ²ßÇé¾°£¬Ë°/²¹ÌùÄÚÉú
        227  $constraint:t_re(sub_elec)$(wsb(sub_elec) and tax_s ne 1)
        228          yelec(sub_elec) =e=ret0(sub_elec);
        229
        230  $constraint:t_re(sub_elec)$(hne(sub_elec) and tax_s ne 1)
        231          yelec(sub_elec) =e=ret0(sub_elec);
        232
        233  $constraint:ur(lm)$ur0(lm)
        234        (Pl(lm)/pu)/(wage("0.11",lm)/pu) =E=(ur(lm)/ur0(lm))**(-0.1);
        235  *     ur0(lm)*(Pl(lm)/wage("0.11",lm))**(-1/10) =e=ur(lm);
        236
        237  $constraint:gprod1$(simu_s ne 0)
        238     gprod1 =e= gprod0*sum(sub_elec,sffelec(sub_elec)*ffelec0(sub_ele
      c)*emkup0(sub_elec)*pffelec(sub_elec)/pk);
        239
        240  $constraint:gprod1$(simu_s eq 0)
        241     gprod1 =e= gprod*sum(sub_elec,sffelec(sub_elec)*ffelec0(sub_elec
      )*emkup0(sub_elec)*pffelec(sub_elec)/pk);
        242
        243  $constraint:gprod3$(simu_s ne 0)
        244  *  gprod3 =e= gprod0*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_el
      ec)*emkup0(sub_elec)*pffelec(sub_elec)/pk);
        245     gprod3 =e= gprod0*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_el
      ec)*emkup0(sub_elec)*pffelec(sub_elec)/pk);
        246
        247  $constraint:gprod3$(simu_s eq 0)
        248  *  gprod3 =e= gprod*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_ele
      c)*emkup0(sub_elec)*pffelec(sub_elec)/pk);
        249     gprod3 =e= gprod*sum(sub_elec,sffelec1(sub_elec)*ffelec0(sub_ele
      c)*emkup0(sub_elec)*pffelec(sub_elec)/pk);
        250
        251
        252
        253  $constraint:gprod2(lm)$(ur0(lm) and simu_s ne 0)
        254    gprod2(lm) =e= gprod0*ur(lm);
        255
        256  $constraint:gprod2(lm)$(ur0(lm) and simu_s eq 0)
        257   gprod2(lm) =e= gprod*ur(lm);
        258
        259  $constraint:rgdp
        260    pu*rgdp =e= pcons*(sum(i,cons0(i))+sum(f,consf0(f)))*consum+pinv*
      (sum(i,inv0(i)))*invest+sum(i,py(i)*((nx0(i)+xinv0(i)+xcons0(i))*xscale)) 
        ;
        261
        262  $constraint:gprod$(simu_s eq 0)
        263    rgdp =e= rgdp0;
        264
        265  $constraint:gprod$(simu_s ne 0)
        266    gprod =e= gprod0;
        267
        268  $constraint:tclim$clim
        269  *×ÜÁ¿Ä¿±ê
        270  *   tclim =e= clim0*temission2("co2");
        271
        272    tclim =e= clim0*temission2("co2")/rgdp0*rgdp;
        273
        274  $report:
        275
        276  v:qdout(j)             o:py(j)       prod:y(j)     !output by secto
      r(domestic market)
        277
        278  v:qc(i)                i:py(i)       prod:consum   !consumpiton of 
      final commodities
        279  v:grosscons            o:pcons       prod:consum   !aggregate consu
      mpiton
        280
        281  v:qinvk(i)             i:py(i)       prod:invest   !physical capita
      l investment by non-energy sectors
        282  v:grossinvk            o:pinv        prod:invest   !aggregate physi
      cal capital investment
        283
        284
        285  v:util                 o:pu          prod:welf       !welf
        286
        287  v:qin(i,j)             i:py(i)       prod:y(j)      !inputs of inte
      rmediate goods
        288  v:qin_ele(i,sub_elec)  i:py(i)       prod:yelec(sub_elec)      !inp
      uts of intermediate goods to fossil fuel fired generation
        289
        290  v:qkin(j)              i:pk          prod:y(j)        !capital inpu
      ts
        291  *v:qkein(sub_elec)$(not TD(sub_elec))                o:pk_e(sub_ele
      c)        prod:yelec(sub_elec)   !capital inputs
        292  *v:qkt                  i:pk_s        prod:k_a         !capital sup
      ply
        293  *v:qk                   o:pk          prod:k_a        !capital inpu
      ts
        294  *v:qke(sub_elec)$(not TD(sub_elec))                o:pk_e(sub_elec)
              prod:k_a        !capital inputs
        295
        296  v:qlin(lm,j)           i:pl(lm)      prod:y(j)        !labor inputs
        297  v:qlin_ele(lm,sub_elec)      i:pl(lm)      prod:yelec(sub_elec)    
          !labor inputs
        298  v:qkin_ele(sub_elec)   i:pk          prod:yelec(sub_elec)        !c
      apital inputs
        299  v:qffin(j)$x(j)        i:pffact(j)   prod:y(j)        !fixed factor
       inputs
        300
        301  v:qffelec(sub_elec)$ffelec0(sub_elec)    i:pffelec(sub_elec)     pr
      od:yelec(sub_elec)      !fixed factor inputs
        302
        303  V:qelec1(sub_elec)$(not wse(sub_elec))        o:pe_base       prod:
      yelec(sub_elec)
        304  V:qelec2(sub_elec)$(wse(sub_elec))            o:pelec(sub_elec)    
                 prod:yelec(sub_elec)
        305
        306  v:ECO2(i)              i:pco2         prod:y(i)
        307  v:ECO2_s(i)              i:pco2_s(i)        prod:y(i)
        308  v:ECO2_e(sub_elec)     i:pco2       prod:yelec(sub_elec)
        309  v:eco2_h               i:pco2        prod:consum
        310  v:EsO2(i)              i:pso2        prod:y(i)
        311  v:EHsO2                i:pso2        prod:consum
        312  $offtext
       
       
      Symbol Listing
       
      Note:   Parameter and set references appearing within
              parentheses are not identified by the preprocessor.
       
      Symbol      Type       References
      ==========  =====      ==================================================
      "0.11"      SET            71   72   82   83   96   97  106  107  118  119
                                133  134
      "CAPITAL"   SET           117  132  179
      "E"         SET           114  130
      "ELEC"      SET            87   92  102
      "ELE_P"     SET           112
      "ENE_FD"    SET           145
      "ENE_P"     SET           112
      "FF"        SET            92  102  112  128
      "KL"        SET            92  102  128
      "L"         SET            66   77   92  102  112  128
      "PROCESS"   SET           114  130
      "SO2"       SET           114  130
      BT          SET            10
      CLIM_H      PARAM         197
      CLIM_S      PARAM         196
      CONS0       PARAM         147
      CONSUM      ACTIV           4  145  278  279  309  311
      EB          ACTIV          10
      ECO2        REPRT         306
      ECO2_E      REPRT         308
      ECO2_H      REPRT         309
      ECO2_S      REPRT         307
      EHSO2       REPRT         311
      ELEC        SET            69   81  120
      EMISSION0   PARAM         114  130
      ENESTA      PARAM          55   77
      ESLM        PARAM          66   77   92  102  112  128
      ESO2        REPRT         310
      ESUB        PARAM          92   92  102  102  112  128  128
      ESUB_C      PARAM         145
      ESUB_INV    PARAM         157
      FACT        PARAM         179
      FACT0       PARAM         117  132
      FE          SET            70   85  121  136  149
      FFACT0      PARAM         115  135  185
      GPROD       AUXIL          41  179  182
      GPROD1      AUXIL          42  180
      GPROD2      AUXIL          44  183
      GPROD3      AUXIL          43  181
      GROSSCONS   REPRT         279
      GROSSINVK   REPRT         282
      I           SET             3   55   56   56   68   68   80   95  105  112
                                112  113  113  114  115  115  116  117  118  119
                                123  128  128  128  129  129  130  131  132  133
                                134  135  135  138  147  147  148  159  159  190
                                196  196  278  278  281  281  287  287  288  288
                                306  306  307  307  307  310  310
      INT0        PARAM         116  131
      INTELEC0    PARAM          68
      INV0        PARAM         159
      INVEST      ACTIV           5  157  281  282
      J           SET           116  116  131  131  276  276  276  287  287  290
                                290  296  296  299  299  299
      KELEC0      PARAM          73
      LABOR0      PARAM         118  119  133  134
      LABORELEC0  PARAM          71   72
      LM          SET            16   71   71   71   72   72   72   82   82   83
                                 83   96   96   97   97  106  106  107  107  118
                                118  118  119  119  119  133  133  133  134  134
                                134  182  183  183  296  296  297  297
      OUTPUT0     PARAM          56
      OUTPUTELEC  PARAM          57   58   93
      PCO2        PRICE          28   86  122  137  150  194  306  308  309
      PCO2_H      PRICE          30  151  197
      PCO2_S      PRICE          29   87  123  138  196  307
      PCONS       PRICE          22  146  167  279
      PELEC       PRICE          14   57   58   67  103  304
      PE_BASE     PRICE          15   59   79   93  303
      PFFACT      PRICE          20  115  135  185  299
      PFFELEC     PRICE          21   99  109  186  301
      PINV        PRICE          23  158  168  282
      PK          PRICE          17   73   84   98  108  117  132  179  180  181
                                290  298
      PL          PRICE          16   71   72   82   83   96   97  106  107  118
                                119  133  134  182  183  296  297
      PSO2        PRICE          31   88  114  124  130  139  152  198  310  311
      PU          PRICE          24  166  175  285
      PY          PRICE          13   56   68   69   70   80   81   85   95  105
                                113  116  120  121  129  131  136  147  148  149
                                159  190  276  278  281  287  288
      QC          REPRT         278
      QDOUT       REPRT         276
      QELEC1      REPRT         303
      QELEC2      REPRT         304
      QFFELEC     REPRT         301
      QFFIN       REPRT         299
      QIN         REPRT         287
      QINVK       REPRT         281
      QIN_ELE     REPRT         288
      QKIN        REPRT         290
      QKIN_ELE    REPRT         298
      QLIN        REPRT         296
      QLIN_ELE    REPRT         297
      RA          CONSU          34   67   79   93  103  113  129  171
      RGDP        AUXIL          40
      SFF         AUXIL          37  185
      SFFELEC     AUXIL          38  186
      SIGMA       PARAM         112  112  145
      SLIM        PARAM         198
      SUB_ELEC    SET             7   57   57   58   58   66   67   67   68   71
                                 72   73   77   79   92   92   93   93   99  102
                                102  103  103  109  186  186  288  288  297  297
                                298  298  301  301  301  303  303  304  304  304
                                308  308
      TAXELEC0    PARAM          67   79
      TCLIM       AUXIL          46  194
      TX0         PARAM         113  129
      T_RE        AUXIL          45   93  103
      UR          AUXIL          39
      UTIL        REPRT         285
      WAGE        PARAM          71   72   82   83   96   97  106  107  118  119
                                133  134
      WELF        ACTIV           6  165  285
      X           SET            37  185  185  185
      Y           ACTIV           3   55  112  128  276  287  290  296  299  306
                                307  310
      YELEC       ACTIV           7   66   77   92  102  288  297  298  301  303
                                304  308
       
2083   
2086  CHINA3E.INTEGER1=1;
EXIT C:\GAMS\win64\24.4\mpsgeset
2089   
2090  *carbon has zero price in the benchmark
2091   
2092  *initialize constraints
2093   
2094  sff.l(x)$ffact0(x)  =1;
2095  pu.fx=1;
2096  ur.l(lm)=ur0(lm);
2097  ur.lo(lm)=B*ur0(lm);
2098  ur.lo(lm)=0.0000001;
2099  t_re.l(sub_elec)$ret0(sub_elec)=taxelec0(sub_elec);
2100  t_re.lo(sub_elec)$ret0(sub_elec)=-inf;
2101  gprod.l=1;
2102  gprod.lo=0;
2103   
2104  tclim.l=temission2("co2");
2105  clim=0;
2106  clim0=0.7;
2107   
2108  *ret0("solar_elec")=100;
2109   
2110   
2111  *ur0(lm)=0;
2112  *clim_s("construction")=0.5*Temission0('co2',"construction");
2113  *clim_s("transport")=1*Temission0('co2',"transport");
2114  *clim_s("EII")=0.5*Temission0('co2',"EII");
2115  *clim_s("elec")=0.7*Temission0('co2',"elec");
2116  *clim=1*Temission1('co2');
2117   
2118  *benchmark calibration
2119   
2120  China3E.iterlim =100000;
2121   
INCLUDE    C:\Users\hero\Desktop\Github\test model - V17\China3E.gen
2271  {   71}    LOOP((LM)$(LL(LM)),
****                         $140
**** LINE    149 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\China
                             3E.gen
**** LINE    379 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\core.
                             gms
**** LINE     13 INPUT       C:\Users\hero\Desktop\Github\test model - V17\run.g
                             ms
2279  {   72}    LOOP((LM)$(HL(LM)),
****                         $140
**** LINE    157 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\China
                             3E.gen
**** LINE    379 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\core.
                             gms
**** LINE     13 INPUT       C:\Users\hero\Desktop\Github\test model - V17\run.g
                             ms
2525  {  118}      IF(ABS(LABOR0(I,LM)) GT MPSEPS,
****                           $140
**** LINE    403 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\China
                             3E.gen
**** LINE    379 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\core.
                             gms
**** LINE     13 INPUT       C:\Users\hero\Desktop\Github\test model - V17\run.g
                             ms
3038   
3039  solve China3E using mcp;
****                         $257
**** LINE    381 INCLUDE     C:\Users\hero\Desktop\Github\test model - V17\core.
                             gms
**** LINE     13 INPUT       C:\Users\hero\Desktop\Github\test model - V17\run.g
                             ms
3040   
3041  display China3E.modelstat, China3E.solvestat,rgdp.l,gprod.l;
3042   
3043  *check2(sub_elec)     =   outputelec0(sub_elec)*(1-taxelec0(sub_elec))-emk
      up(sub_elec)*(sum(i,intelec0(i,sub_elec))+kelec0(sub_elec)+ffelec0(sub_ele
      c)+sum(lm,wage('0.11',lm)*laborelec0(sub_elec,lm)));
3044  check2 = sum(i,fact0("capital",i))-fact0("capital","elec")+sum(sub_elec,ke
      lec0(sub_elec)*emkup(sub_elec))-fact("capital");
3045  display check2,emkup;
3046   
3047   
3048  *parameter chek1 ;
3049  *chek1=pcons.l*grosscons.l+pinv.l*grossinvk.l+pe.l*grossexp.l-sum(i,pm.l(i
      )*qimp.l(i));;
3050  *chek2(i)=output0(i)-sum(j,int0(j,i))-fact0("capital",i)-sum(lm,labor0(i,l
      m))-ffact0(i);
3051  *chek3(sub_elec)=outputelec0(sub_elec)*(1-taxelec0(sub_elec))-sum(i,intele
      c0(i,sub_elec))-kelec0(sub_elec)-sum(lm,laborelec0(sub_elec,lm))
3052  *chek2(i)=fact0("labor",i)-sum(lm,labor0(i,lm));
3053  *display chek1;
3054   
3055   
3056   
3057  parameter
3058  report1    reporting variable
3059  report2    reporting variable
3060  report3    reporting variable
3061  report4    reporting variable
3062  report5
3063  report6
3064  report7
3065  report8
3066  report9
3067  report10
3068  report11
3069  report12
3070  ;
3071  *UNEM
3072  *Pwage;;
3073   
3074  *report1(lm)=sum(i,qlin.l(lm,i))+sum(sub_elec,qlin_ele.l(lm,sub_elec));
3075  *report1(lm)=ur.l(lm)-ur0(lm);
3076  *report1(lm)=ur0(lm)*(pl.l(lm)/wage("0.11",lm))**(-10)-ur.l(lm);
3077  *display report1;
3078   
       
       
       
      *set rate reduction rate /0,10,20,30,40,50,60,70,80,90/  ;
      set z reduction rate /0,1,2,3,4,5,6,7,8,9/  ;
      parameter rate(z) /0=0,
                         1=0.1,
                         2=0.2,
                         3=0.3,
                         4=0.4,
                         5=0.5,
                         6=0.6,
                         7=0.7,
                         8=0.8,
                         9=0.9/;
       
       
      loop(z,
      *clim=(1-(ord(rate)-1)/10)*Temission1("co2");
      *clim_s("elec")=(1-(ord(rate)-1)/10)*Temission0('co2',"elec");
      *clim_s("EII")=(1-(ord(rate)-1)/10)*Temission0('co2',"EII");
      *clim_s("construction")=(1-(ord(rate)-1)/10)*Temission0('co2',"constructio
      n");
      clim_s("elec")=(1-rate(z))*Temission0('co2',"elec");
       
      *sigma("kle_ele") = rate(z)*0.6;
      $include China3E.gen
       
      solve China3E using mcp;
       
      display China3E.modelstat, China3E.solvestat,clim,rate,sigma;
       
      UNEM(lm,z)=UR.l(lm);
      pwage(lm,z)=pl.l(lm);
       
      report1(z,i)=qdout.l(i);
      report2(z,i)=sum(fe,ccoef_p(fe)*qin.l(fe,i));
      report2(z,sub_elec)=sum(fe,ccoef_p(fe)*qin_ele.l(fe,sub_elec));
      report2(z,fe)=0;
      report2(z,"household")=sum(fe,ccoef_h(fe)*qc.l(fe));
      report3(z,i,j)=qin.l(i,j);
      report3(z,i,sub_elec)=qin_ele.l(i,sub_elec);
      report3(z,i,"household")=qc.l(i);
      report4(z,i)=qffin.l(i);
      report4(z,sub_elec)=qffelec.l(sub_elec);
      report5(z)=   pcons.l*grosscons.l+pinv.l*grossinvk.l+sum(i,py.l(i)*((nx0(i
      )+xinv0(i)+xcons0(i))*xscale));
      report6(z,lm)= sum(i,qlin.l(lm,i))+sum(sub_elec,qlin_ele.l(lm,sub_elec));
      report7(z)= sum(i,qkin.l(i))+sum(sub_elec,qkin_ele.l(sub_elec));
      report8(z,sub_elec)=qelec.l(sub_elec);
      report9(z,sub_elec,lm)=qlin_ele.l(lm,sub_elec);
       
      );
      execute_unload "results.gdx" UNEM Pwage report1 report2 report3  report4 r
      eport5  report6 report7 report8  report9
      execute 'gdxxrw.exe results.gdx par=unem rng=UNEM!'
      execute 'gdxxrw.exe results.gdx par=Pwage rng=wage!'
      execute 'gdxxrw.exe results.gdx par=report1 rng=output!'
      execute 'gdxxrw.exe results.gdx par=report2 rng=emission!'
      execute 'gdxxrw.exe results.gdx par=report3 rng=input!'
      execute 'gdxxrw.exe results.gdx par=report4 rng=ffactor!'
      execute 'gdxxrw.exe results.gdx par=report5 rng=GDP!'
      execute 'gdxxrw.exe results.gdx par=report6 rng=labor!'
      execute 'gdxxrw.exe results.gdx par=report7 rng=capital!'
      execute 'gdxxrw.exe results.gdx par=report8 rng=ele_out!'
      execute 'gdxxrw.exe results.gdx par=report9 rng=ele_labor!'
       
STOP C:\Users\hero\Desktop\Github\test model - V17\run.gms
GAMS 24.4.6  r52609 Released Jun 26, 2015 WEX-WEI x86 64bit/MS Windows 12/05/16 17:23:03 Page 3
a dynamic CGE model of China economy-environment-energy policy analysis based on 2012 data
Error Messages


140  Unknown symbol
257  Solve statement not checked because of previous errors

**** 5 ERROR(S)   0 WARNING(S)
GAMS 24.4.6  r52609 Released Jun 26, 2015 WEX-WEI x86 64bit/MS Windows 12/05/16 17:23:03 Page 4
a dynamic CGE model of China economy-environment-energy policy analysis based on 2012 data
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\hero\Desktop\Github\test mode
                                          l - V17\run.gms
     2        1 INCLUDE        1       1  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\sets.gms
     3      110 CALL           2     109  .GDXXRW.EXE data.xlsx par=sam rng=A1
     4      115 GDXIN          2     114  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\data.gdx
     5      253 INCLUDE        1       3  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\subsititution elasticities.g
                                           ms
     6      323 INCLUDE        1       4  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\emission data.gms
     7      484 INCLUDE        1       6  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\electricity.gms
     8      490 CALL           7       6  .GDXXRW.EXE elec.xlsx par=Eprop rng=A1
                                           :J34
     9      495 GDXIN          7      11  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\elec.gdx
    10      594 INCLUDE        1       7  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\ist.gms
    11      598 CALL          10       4  .GDXXRW.EXE ist.xlsx par=isprop rng=A1
                                           :C29
    12      601 GDXIN         10       7  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\ist.gdx
    13      643 INCLUDE        1       8  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\trend.gms
    14      648 CALL          13       5  .GDXXRW.EXE trend.xlsx par=PAT rng=A1:
                                           D18   par=RET1 rng=A26:I35   par=RET2
                                           rng=A37:I46   par=sffelec_b rng=A47:I
                                           57  par=sffelec_BAU rng=A58:I68
    15      655 GDXIN         13      12  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\trend.gdx
    16      698 INCLUDE        1       9  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\labor market.gms
    17      722 CALL          16      24  .GDXXRW.EXE labor.xlsx par=labor_q0 rn
                                           g=A1:AC19  par=labor_v0 rng=A21:AC39 
                                           par=labordata  rng=A41:AC43
    18      729 GDXIN         16      31  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\labor.gdx
    19      938 INCLUDE        1      11  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\backstop.gms
    20      997 INCLUDE        1      13  .C:\Users\hero\Desktop\Github\test mod
                                           el - V17\core.gms
    21     1342 SYSINCLUDE    20     345  ..C:\GAMS\win64\24.4\mpsgeset
    22     1361 CALL          21      19  ..gmsge_nx "C:\Users\hero\Desktop\Gith
                                            ub\test model - V17\225a\gamscge.dat
                                            "
    23     1362 INCLUDE       21      20  ...C:\Users\hero\Desktop\Github\test m
                                             odel - V17\225a\gamsgeh.dat
    24     2088 EXIT          21      22  ..C:\GAMS\win64\24.4\mpsgeset
    25     2122 INCLUDE       20     379  ..C:\Users\hero\Desktop\Github\test mo
                                            del - V17\China3E.gen
    26     3037 EXIT          25     915  ..C:\Users\hero\Desktop\Github\test mo
                                            del - V17\China3E.gen
    27     3145 STOP           1      14  C:\Users\hero\Desktop\Github\test mode
                                          l - V17\run.gms


COMPILATION TIME     =       10.265 SECONDS      3 MB  24.4.6 r52609 WEX-WEI


USER: Yaqian Mu                                      G150107:0436AO-WIN
      Tsinghua University, Res. Centre for International EnvironmDC6727
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\hero\Desktop\Github\test model - V17\run.gms
Output     C:\Users\hero\Desktop\Github\test model - V17\run.lst

**** USER ERROR(S) ENCOUNTERED
